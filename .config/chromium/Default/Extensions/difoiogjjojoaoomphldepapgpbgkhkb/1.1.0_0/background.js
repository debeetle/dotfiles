"use strict";(()=>{var Bl=Object.create;var Qo=Object.defineProperty;var ql=Object.getOwnPropertyDescriptor;var Gl=Object.getOwnPropertyNames;var Wl=Object.getPrototypeOf,Vl=Object.prototype.hasOwnProperty;var A=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Kl=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Gl(e))!Vl.call(t,o)&&o!==r&&Qo(t,o,{get:()=>e[o],enumerable:!(n=ql(e,o))||n.enumerable});return t};var U=(t,e,r)=>(r=t!=null?Bl(Wl(t)):{},Kl(e||!t||!t.__esModule?Qo(r,"default",{value:t,enumerable:!0}):r,t));var K=A((pn,Yo)=>{(function(t,e){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],e);else if(typeof pn<"u")e(Yo);else{var r={exports:{}};e(r),t.browser=r.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:pn,function(t){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let e="The message port closed before a response was received.",r=n=>{let o={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(o).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(v,x=void 0){super(x),this.createItem=v}get(v){return this.has(v)||this.set(v,this.createItem(v)),super.get(v)}}let i=g=>g&&typeof g=="object"&&typeof g.then=="function",s=(g,v)=>(...x)=>{n.runtime.lastError?g.reject(new Error(n.runtime.lastError.message)):v.singleCallbackArg||x.length<=1&&v.singleCallbackArg!==!1?g.resolve(x[0]):g.resolve(x)},u=g=>g==1?"argument":"arguments",c=(g,v)=>function(S,...C){if(C.length<v.minArgs)throw new Error(`Expected at least ${v.minArgs} ${u(v.minArgs)} for ${g}(), got ${C.length}`);if(C.length>v.maxArgs)throw new Error(`Expected at most ${v.maxArgs} ${u(v.maxArgs)} for ${g}(), got ${C.length}`);return new Promise((R,M)=>{if(v.fallbackToNoCallback)try{S[g](...C,s({resolve:R,reject:M},v))}catch{S[g](...C),v.fallbackToNoCallback=!1,v.noCallback=!0,R()}else v.noCallback?(S[g](...C),R()):S[g](...C,s({resolve:R,reject:M},v))})},f=(g,v,x)=>new Proxy(v,{apply(S,C,R){return x.call(C,g,...R)}}),l=Function.call.bind(Object.prototype.hasOwnProperty),p=(g,v={},x={})=>{let S=Object.create(null),C={has(M,T){return T in g||T in S},get(M,T,F){if(T in S)return S[T];if(!(T in g))return;let N=g[T];if(typeof N=="function")if(typeof v[T]=="function")N=f(g,g[T],v[T]);else if(l(x,T)){let Z=c(T,x[T]);N=f(g,g[T],Z)}else N=N.bind(g);else if(typeof N=="object"&&N!==null&&(l(v,T)||l(x,T)))N=p(N,v[T],x[T]);else if(l(x,"*"))N=p(N,v[T],x["*"]);else return Object.defineProperty(S,T,{configurable:!0,enumerable:!0,get(){return g[T]},set(Z){g[T]=Z}}),N;return S[T]=N,N},set(M,T,F,N){return T in S?S[T]=F:g[T]=F,!0},defineProperty(M,T,F){return Reflect.defineProperty(S,T,F)},deleteProperty(M,T){return Reflect.deleteProperty(S,T)}},R=Object.create(g);return new Proxy(R,C)},d=g=>({addListener(v,x,...S){v.addListener(g.get(x),...S)},hasListener(v,x){return v.hasListener(g.get(x))},removeListener(v,x){v.removeListener(g.get(x))}}),y=new a(g=>typeof g!="function"?g:function(x){let S=p(x,{},{getContent:{minArgs:0,maxArgs:0}});g(S)}),w=new a(g=>typeof g!="function"?g:function(x,S,C){let R=!1,M,T=new Promise(Se=>{M=function(J){R=!0,Se(J)}}),F;try{F=g(x,S,M)}catch(Se){F=Promise.reject(Se)}let N=F!==!0&&i(F);if(F!==!0&&!N&&!R)return!1;let Z=Se=>{Se.then(J=>{C(J)},J=>{let ve;J&&(J instanceof Error||typeof J.message=="string")?ve=J.message:ve="An unexpected error occurred",C({__mozWebExtensionPolyfillReject__:!0,message:ve})}).catch(J=>{})};return Z(N?F:T),!0}),b=({reject:g,resolve:v},x)=>{n.runtime.lastError?n.runtime.lastError.message===e?v():g(new Error(n.runtime.lastError.message)):x&&x.__mozWebExtensionPolyfillReject__?g(new Error(x.message)):v(x)},m=(g,v,x,...S)=>{if(S.length<v.minArgs)throw new Error(`Expected at least ${v.minArgs} ${u(v.minArgs)} for ${g}(), got ${S.length}`);if(S.length>v.maxArgs)throw new Error(`Expected at most ${v.maxArgs} ${u(v.maxArgs)} for ${g}(), got ${S.length}`);return new Promise((C,R)=>{let M=b.bind(null,{resolve:C,reject:R});S.push(M),x.sendMessage(...S)})},h={devtools:{network:{onRequestFinished:d(y)}},runtime:{onMessage:d(w),onMessageExternal:d(w),sendMessage:m.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:m.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},O={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return o.privacy={network:{"*":O},services:{"*":O},websites:{"*":O}},p(n,h,o)};t.exports=r(chrome)}else t.exports=globalThis.browser})});var As=A((vT,_s)=>{"use strict";_s.exports=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}});var Ps=A((bT,Ss)=>{"use strict";var Eg=As();function Rg(t,e="maxAge"){let r,n,o,a=async()=>{if(r!==void 0)return;let u=async c=>{o=Eg();let f=c[1][e]-Date.now();if(f<=0){t.delete(c[0]),o.resolve();return}return r=c[0],n=setTimeout(()=>{t.delete(c[0]),o&&o.resolve()},f),typeof n.unref=="function"&&n.unref(),o.promise};try{for(let c of t)await u(c)}catch{}r=void 0},i=()=>{r=void 0,n!==void 0&&(clearTimeout(n),n=void 0),o!==void 0&&(o.reject(void 0),o=void 0)},s=t.set.bind(t);return t.set=(u,c)=>{t.has(u)&&t.delete(u);let f=s(u,c);return r&&r===u&&i(),a(),f},a(),t}Ss.exports=Rg});var Bn=A((xT,Ts)=>{"use strict";var Ig=Ps(),$n=class{constructor(e,r){if(this.maxAge=e,this[Symbol.toStringTag]="Map",this.data=new Map,Ig(this.data),r)for(let[n,o]of r)this.set(n,o)}get size(){return this.data.size}clear(){this.data.clear()}delete(e){return this.data.delete(e)}has(e){return this.data.has(e)}get(e){let r=this.data.get(e);if(r)return r.data}set(e,r){return this.data.set(e,{maxAge:Date.now()+this.maxAge,data:r}),this}values(){return this.createIterator(e=>e[1].data)}keys(){return this.data.keys()}entries(){return this.createIterator(e=>[e[0],e[1].data])}forEach(e,r){for(let[n,o]of this.entries())e.apply(r,[o,n,this])}[Symbol.iterator](){return this.entries()}*createIterator(e){for(let r of this.data.entries())yield e(r)}};Ts.exports=$n});var eu=A((uO,Xs)=>{"use strict";function Qs(t){return(Qs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function Kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hs(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zt(t,e,r){return e&&Hs(t.prototype,e),r&&Hs(t,r),t}function kh(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ys(t,e)}function eo(t){return(eo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function Ys(t,e){return(Ys=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(t,e)}function Ch(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Eh(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rh(t,e){return!e||typeof e!="object"&&typeof e!="function"?Eh(t):e}function Ih(t){var e=Ch();return function(){var r,n=eo(t);if(e){var o=eo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Rh(this,r)}}function Js(t){return jh(t)||Lh(t)||Nh(t)||Mh()}function jh(t){if(Array.isArray(t))return to(t)}function Lh(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Nh(t,e){if(t){if(typeof t=="string")return to(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?to(t,e):void 0}}function to(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mh(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ro=function(){function t(e){Kt(this,t),this._listeners=[],this._mute=!1,this._accumulate=!1,this._accumulatedEvents=[],this._name=e||"",this._onListenerAdded=null,this._onFirstListenerAdded=null,this._onListenerRemoved=null,this._onLastListenerRemoved=null}return zt(t,[{key:"addListener",value:function(e,r){this._pushListener(e,r,!1)}},{key:"addOnceListener",value:function(e,r){this._pushListener(e,r,!0)}},{key:"removeListener",value:function(e,r){this._ensureListener(e);var n=this._indexOfListener(e,r);0<=n&&this._spliceListener(n)}},{key:"removeAllListeners",value:function(){for(;this.hasListeners();)this._spliceListener(0)}},{key:"hasListener",value:function(e,r){return this._ensureListener(e),0<=this._indexOfListener(e,r)}},{key:"hasListeners",value:function(){return 0<this._listeners.length}},{key:"dispatch",value:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this._invokeListeners({args:r,async:!1})}},{key:"dispatchAsync",value:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this._invokeListeners({args:r,async:!0})}},{key:"mute",value:function(e){var r=0<arguments.length&&e!==void 0?e:{};this._mute=!0,r.accumulate?this._accumulate=!0:(this._accumulate=!1,this._accumulatedEvents=[])}},{key:"unmute",value:function(){this._mute=!1,this._accumulate&&(this._dispatchAccumulated(),this._accumulate=!1)}},{key:"_invokeListeners",value:function(e){var r=this,n=0<arguments.length&&e!==void 0?e:{args:[],async:!1};this._mute?this._accumulate&&this._accumulatedEvents.push(n):this._listeners.slice().forEach(function(o){r._invokeListener(o,n),o.once&&r.removeListener(o.callback,o.context)})}},{key:"_invokeListener",value:function(e,r){var n,o,a=e.callback instanceof t;r.async?a?(n=e.callback).dispatchAsync.apply(n,Js(r.args)):setTimeout(function(){return e.callback.apply(e.context,r.args)},0):a?(o=e.callback).dispatch.apply(o,Js(r.args)):e.callback.apply(e.context,r.args)}},{key:"_ensureListener",value:function(e){if(!t.isValidListener(e))throw new Error("Channel "+this._name+": listener is not a function and not a Channel")}},{key:"_dispatchInnerAddEvents",value:function(){var e,r;this._onListenerAdded&&(e=this._onListenerAdded).dispatch.apply(e,arguments),this._onFirstListenerAdded&&this._listeners.length===1&&(r=this._onFirstListenerAdded).dispatch.apply(r,arguments)}},{key:"_dispatchInnerRemoveEvents",value:function(){var e,r;this._onListenerRemoved&&(e=this._onListenerRemoved).dispatch.apply(e,arguments),this._onLastListenerRemoved&&this._listeners.length===0&&(r=this._onLastListenerRemoved).dispatch.apply(r,arguments)}},{key:"_indexOfListener",value:function(e,r){for(var n=0;n<this._listeners.length;n++){var o=this._listeners[n],a=o.callback===e,i=e instanceof t,s=r===void 0&&o.context===void 0,u=r===o.context;if(a&&(i||s||u))return n}}},{key:"_dispatchAccumulated",value:function(){var e=this;this._accumulatedEvents.forEach(function(r){return e._invokeListeners(r)}),this._accumulatedEvents=[]}},{key:"_pushListener",value:function(e,r,n){this._ensureListener(e),this._checkForDuplicates(e,r),this._listeners.push({callback:e,context:r,once:n}),this._dispatchInnerAddEvents(e,r,n)}},{key:"_checkForDuplicates",value:function(e,r){if(this.hasListener(e,r))throw new Error("Channel "+this._name+": duplicating listeners")}},{key:"_spliceListener",value:function(e){var r=this._listeners[e],n=r.callback,o=r.context,a=r.once;this._listeners.splice(e,1),this._dispatchInnerRemoveEvents(n,o,a)}},{key:"onListenerAdded",get:function(){return this._onListenerAdded||(this._onListenerAdded=new t("".concat(this._name,":onListenerAdded"))),this._onListenerAdded}},{key:"onFirstListenerAdded",get:function(){return this._onFirstListenerAdded||(this._onFirstListenerAdded=new t("".concat(this._name,":onFirstListenerAdded"))),this._onFirstListenerAdded}},{key:"onListenerRemoved",get:function(){return this._onListenerRemoved||(this._onListenerRemoved=new t("".concat(this._name,":onListenerRemoved"))),this._onListenerRemoved}},{key:"onLastListenerRemoved",get:function(){return this._onLastListenerRemoved||(this._onLastListenerRemoved=new t("".concat(this._name,":onLastListenerRemoved"))),this._onLastListenerRemoved}}],[{key:"isValidListener",value:function(e){return typeof e=="function"||e instanceof t}}]),t}(),Dh=function(){function t(){Kt(this,t),this._channels=new Map}return zt(t,[{key:"addListener",value:function(e,r,n){this._getChannel(e).addListener(r,n)}},{key:"on",value:function(e,r,n){this.addListener(e,r,n)}},{key:"addOnceListener",value:function(e,r,n){this._getChannel(e).addOnceListener(r,n)}},{key:"once",value:function(e,r,n){this.addOnceListener(e,r,n)}},{key:"removeListener",value:function(e,r,n){this._getChannel(e).removeListener(r,n)}},{key:"off",value:function(e,r,n){this.removeListener(e,r,n)}},{key:"hasListener",value:function(e,r,n){return this._getChannel(e).hasListener(r,n)}},{key:"has",value:function(e,r,n){return this.hasListener(e,r,n)}},{key:"hasListeners",value:function(e){return this._getChannel(e).hasListeners()}},{key:"dispatch",value:function(e){for(var r,n=arguments.length,o=new Array(1<n?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];(r=this._getChannel(e)).dispatch.apply(r,o)}},{key:"emit",value:function(e){for(var r=arguments.length,n=new Array(1<r?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];this.dispatch.apply(this,[e].concat(n))}},{key:"_getChannel",value:function(e){return this._channels.has(e)||this._channels.set(e,new ro(e)),this._channels.get(e)}}]),t}(),Fh=function(){function t(e){Kt(this,t),this._params=e,this._isOn=!1,this._assertParams()}return zt(t,[{key:"on",value:function(){if(!this._isOn){var e=this._params.channel,r=e.addListener||e.addEventListener||e.on;this._applyMethod(r),this._isOn=!0}}},{key:"off",value:function(){if(this._isOn){var e=this._params.channel,r=e.removeListener||e.removeEventListener||e.off;this._applyMethod(r),this._isOn=!1}}},{key:"_applyMethod",value:function(e){var r=this._params,n=r.channel,o=r.event,a=r.listener,i=o?[o,a]:[a];e.apply(n,i)}},{key:"_assertParams",value:function(){var e=this._params,r=e.channel,n=e.event,o=e.listener;if(!r||Qs(r)!=="object")throw new Error("Channel should be object");if(n&&typeof n!="string")throw new Error("Event should be string");if(!o||!ro.isValidListener(o))throw new Error("Listener should be function or Channel")}}]),t}(),Zs=function(){function t(e){Kt(this,t),this._items=e.map(function(r){return new Fh(r)})}return zt(t,[{key:"on",value:function(){return this._items.forEach(function(e){return e.on()}),this}},{key:"off",value:function(){return this._items.forEach(function(e){return e.off()}),this}}]),t}(),Uh=function(){kh(e,Zs);var t=Ih(e);function e(r,n){var o;return Kt(this,e),(o=t.call(this,n))._overrideComponentCallback(r,"componentDidMount","on"),o._overrideComponentCallback(r,"componentWillUnmount","off"),o}return zt(e,[{key:"_overrideComponentCallback",value:function(r,n,o){var a=this,i=r[n];r[n]=function(){if(a[o](),typeof i=="function"){for(var s=arguments.length,u=new Array(s),c=0;c<s;c++)u[c]=arguments[c];return i.apply(r,u)}}}}]),e}(),Dr=ro;Dr.EventEmitter=Dh,Dr.Subscription=Zs,Dr.ReactSubscription=Uh,Xs.exports=Dr});var ru=A((cO,tu)=>{tu.exports={timeout:0,timeoutReason:"Promise rejected by PromiseController timeout {timeout} ms.",resetReason:"Promise rejected by PromiseController reset."}});var nu=A(Fr=>{Fr.isPromise=function(t){return t&&typeof t.then=="function"};Fr.tryCall=function(t){return typeof t=="function"?t():t};Fr.createErrorType=function(t){function e(r){Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r}return e.prototype=new Error,e.prototype.name=t,e.prototype.constructor=e,e}});var no=A((fO,su)=>{var $h=ru(),{isPromise:ou,createErrorType:iu,tryCall:au}=nu(),$e=class{constructor(e){this._options=Object.assign({},$h,e),this._resolve=null,this._reject=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._promise=null,this._timer=null}get promise(){return this._promise}get value(){return this._value}get isPending(){return this._isPending}get isFulfilled(){return this._isFulfilled}get isRejected(){return this._isRejected}get isSettled(){return this._isFulfilled||this._isRejected}call(e){return this._isPending||(this.reset(),this._createPromise(),this._createTimer(),this._callFn(e)),this._promise}resolve(e){this._isPending&&(ou(e)?this._tryAttachToPromise(e):(this._settle(e),this._isFulfilled=!0,this._resolve(e)))}reject(e){this._isPending&&(this._settle(e),this._isRejected=!0,this._reject(e))}reset(){if(this._isPending){let e=au(this._options.resetReason),r=new $e.ResetError(e);this.reject(r)}this._promise=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._clearTimer()}configure(e){Object.assign(this._options,e)}_createPromise(){this._promise=new Promise((e,r)=>{this._isPending=!0,this._resolve=e,this._reject=r})}_handleTimeout(){let e=au(this._options.timeoutReason),r=typeof e=="string"?e.replace("{timeout}",this._options.timeout):"",n=new $e.TimeoutError(r);this.reject(n)}_createTimer(){this._options.timeout&&(this._timer=setTimeout(()=>this._handleTimeout(),this._options.timeout))}_clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null)}_settle(e){this._isPending=!1,this._value=e,this._clearTimer()}_callFn(e){if(typeof e=="function")try{let r=e();this._tryAttachToPromise(r)}catch(r){this.reject(r)}}_tryAttachToPromise(e){ou(e)&&e.then(r=>this.resolve(r),r=>this.reject(r))}};$e.TimeoutError=iu("TimeoutError");$e.ResetError=iu("ResetError");su.exports=$e});var uu=A(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.PromisedMap=void 0;var Bh=function(){function t(){this.map=new Map}return Object.defineProperty(t.prototype,"size",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),t.prototype.set=function(e,r){var n=this.createMapItem(r);return this.map.set(e,n),n.promise},t.prototype.get=function(e){var r=this.map.get(e);return r&&r.data},t.prototype.has=function(e){return this.map.has(e)},t.prototype.delete=function(e){return this.map.delete(e)},t.prototype.resolve=function(e,r){var n=this.map.get(e);n&&(this.delete(e),n.resolve(r))},t.prototype.reject=function(e,r){var n=this.map.get(e);n&&(this.delete(e),n.reject(r))},t.prototype.resolveAll=function(e){this.map.forEach(function(r){return r.resolve(e)}),this.map.clear()},t.prototype.rejectAll=function(e){this.map.forEach(function(r){return r.reject(e)}),this.map.clear()},t.prototype.forEach=function(e){this.map.forEach(function(r,n,o){return e(r.data,n,o)})},t.prototype.clear=function(){return this.map.clear()},t.prototype.createMapItem=function(e){var r={data:e};return r.promise=new Promise(function(n,o){r.resolve=n,r.reject=o}),r},t}();Ur.PromisedMap=Bh});var lu=A((dO,cu)=>{"use strict";var qh="Function.prototype.bind called on incompatible ",oo=Array.prototype.slice,Gh=Object.prototype.toString,Wh="[object Function]";cu.exports=function(e){var r=this;if(typeof r!="function"||Gh.call(r)!==Wh)throw new TypeError(qh+r);for(var n=oo.call(arguments,1),o,a=function(){if(this instanceof o){var f=r.apply(this,n.concat(oo.call(arguments)));return Object(f)===f?f:this}else return r.apply(e,n.concat(oo.call(arguments)))},i=Math.max(0,r.length-n.length),s=[],u=0;u<i;u++)s.push("$"+u);if(o=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(a),r.prototype){var c=function(){};c.prototype=r.prototype,o.prototype=new c,c.prototype=null}return o}});var $r=A((mO,fu)=>{"use strict";var Vh=lu();fu.exports=Function.prototype.bind||Vh});var du=A((gO,pu)=>{"use strict";pu.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;e[r]=o;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var i=Object.getOwnPropertyDescriptor(e,r);if(i.value!==o||i.enumerable!==!0)return!1}return!0}});var hu=A((hO,gu)=>{"use strict";var mu=typeof Symbol<"u"&&Symbol,Kh=du();gu.exports=function(){return typeof mu!="function"||typeof Symbol!="function"||typeof mu("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Kh()}});var Be=A((yO,yu)=>{"use strict";var zh=$r();yu.exports=zh.call(Function.call,Object.prototype.hasOwnProperty)});var se=A((vO,wu)=>{"use strict";var k,At=SyntaxError,xu=Function,wt=TypeError,ao=function(t){try{return xu('"use strict"; return ('+t+").constructor;")()}catch{}},Xe=Object.getOwnPropertyDescriptor;if(Xe)try{Xe({},"")}catch{Xe=null}var io=function(){throw new wt},Hh=Xe?function(){try{return arguments.callee,io}catch{try{return Xe(arguments,"callee").get}catch{return io}}}():io,bt=hu()(),qe=Object.getPrototypeOf||function(t){return t.__proto__},xt={},Jh=typeof Uint8Array>"u"?k:qe(Uint8Array),_t={"%AggregateError%":typeof AggregateError>"u"?k:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?k:ArrayBuffer,"%ArrayIteratorPrototype%":bt?qe([][Symbol.iterator]()):k,"%AsyncFromSyncIteratorPrototype%":k,"%AsyncFunction%":xt,"%AsyncGenerator%":xt,"%AsyncGeneratorFunction%":xt,"%AsyncIteratorPrototype%":xt,"%Atomics%":typeof Atomics>"u"?k:Atomics,"%BigInt%":typeof BigInt>"u"?k:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?k:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?k:Float32Array,"%Float64Array%":typeof Float64Array>"u"?k:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?k:FinalizationRegistry,"%Function%":xu,"%GeneratorFunction%":xt,"%Int8Array%":typeof Int8Array>"u"?k:Int8Array,"%Int16Array%":typeof Int16Array>"u"?k:Int16Array,"%Int32Array%":typeof Int32Array>"u"?k:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":bt?qe(qe([][Symbol.iterator]())):k,"%JSON%":typeof JSON=="object"?JSON:k,"%Map%":typeof Map>"u"?k:Map,"%MapIteratorPrototype%":typeof Map>"u"||!bt?k:qe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?k:Promise,"%Proxy%":typeof Proxy>"u"?k:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?k:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?k:Set,"%SetIteratorPrototype%":typeof Set>"u"||!bt?k:qe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?k:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":bt?qe(""[Symbol.iterator]()):k,"%Symbol%":bt?Symbol:k,"%SyntaxError%":At,"%ThrowTypeError%":Hh,"%TypedArray%":Jh,"%TypeError%":wt,"%Uint8Array%":typeof Uint8Array>"u"?k:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?k:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?k:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?k:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?k:WeakMap,"%WeakRef%":typeof WeakRef>"u"?k:WeakRef,"%WeakSet%":typeof WeakSet>"u"?k:WeakSet},Qh=function t(e){var r;if(e==="%AsyncFunction%")r=ao("async function () {}");else if(e==="%GeneratorFunction%")r=ao("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=ao("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var o=t("%AsyncGenerator%");o&&(r=qe(o.prototype))}return _t[e]=r,r},vu={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ht=$r(),Br=Be(),Yh=Ht.call(Function.call,Array.prototype.concat),Zh=Ht.call(Function.apply,Array.prototype.splice),bu=Ht.call(Function.call,String.prototype.replace),qr=Ht.call(Function.call,String.prototype.slice),Xh=Ht.call(Function.call,RegExp.prototype.exec),ey=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ty=/\\(\\)?/g,ry=function(e){var r=qr(e,0,1),n=qr(e,-1);if(r==="%"&&n!=="%")throw new At("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new At("invalid intrinsic syntax, expected opening `%`");var o=[];return bu(e,ey,function(a,i,s,u){o[o.length]=s?bu(u,ty,"$1"):i||a}),o},ny=function(e,r){var n=e,o;if(Br(vu,n)&&(o=vu[n],n="%"+o[0]+"%"),Br(_t,n)){var a=_t[n];if(a===xt&&(a=Qh(n)),typeof a>"u"&&!r)throw new wt("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:o,name:n,value:a}}throw new At("intrinsic "+e+" does not exist!")};wu.exports=function(e,r){if(typeof e!="string"||e.length===0)throw new wt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new wt('"allowMissing" argument must be a boolean');if(Xh(/^%?[^%]*%?$/,e)===null)throw new At("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=ry(e),o=n.length>0?n[0]:"",a=ny("%"+o+"%",r),i=a.name,s=a.value,u=!1,c=a.alias;c&&(o=c[0],Zh(n,Yh([0,1],c)));for(var f=1,l=!0;f<n.length;f+=1){var p=n[f],d=qr(p,0,1),y=qr(p,-1);if((d==='"'||d==="'"||d==="`"||y==='"'||y==="'"||y==="`")&&d!==y)throw new At("property names with quotes must have matching quotes");if((p==="constructor"||!l)&&(u=!0),o+="."+p,i="%"+o+"%",Br(_t,i))s=_t[i];else if(s!=null){if(!(p in s)){if(!r)throw new wt("base intrinsic for "+e+" exists, but the property is not available.");return}if(Xe&&f+1>=n.length){var w=Xe(s,p);l=!!w,l&&"get"in w&&!("originalValue"in w.get)?s=w.get:s=s[p]}else l=Br(s,p),s=s[p];l&&!u&&(_t[i]=s)}}return s}});var uo=A((bO,Gr)=>{"use strict";var so=$r(),St=se(),Su=St("%Function.prototype.apply%"),Pu=St("%Function.prototype.call%"),Tu=St("%Reflect.apply%",!0)||so.call(Pu,Su),_u=St("%Object.getOwnPropertyDescriptor%",!0),et=St("%Object.defineProperty%",!0),oy=St("%Math.max%");if(et)try{et({},"a",{value:1})}catch{et=null}Gr.exports=function(e){var r=Tu(so,Pu,arguments);if(_u&&et){var n=_u(r,"length");n.configurable&&et(r,"length",{value:1+oy(0,e.length-(arguments.length-1))})}return r};var Au=function(){return Tu(so,Su,arguments)};et?et(Gr.exports,"apply",{value:Au}):Gr.exports.apply=Au});var co=A((xO,ku)=>{"use strict";var Ou=Object.prototype.toString;ku.exports=function(e){var r=Ou.call(e),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Ou.call(e.callee)==="[object Function]"),n}});var Du=A((wO,Mu)=>{"use strict";var Nu;Object.keys||(Jt=Object.prototype.hasOwnProperty,lo=Object.prototype.toString,Cu=co(),fo=Object.prototype.propertyIsEnumerable,Eu=!fo.call({toString:null},"toString"),Ru=fo.call(function(){},"prototype"),Qt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Wr=function(t){var e=t.constructor;return e&&e.prototype===t},Iu={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},ju=function(){if(typeof window>"u")return!1;for(var t in window)try{if(!Iu["$"+t]&&Jt.call(window,t)&&window[t]!==null&&typeof window[t]=="object")try{Wr(window[t])}catch{return!0}}catch{return!0}return!1}(),Lu=function(t){if(typeof window>"u"||!ju)return Wr(t);try{return Wr(t)}catch{return!1}},Nu=function(e){var r=e!==null&&typeof e=="object",n=lo.call(e)==="[object Function]",o=Cu(e),a=r&&lo.call(e)==="[object String]",i=[];if(!r&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var s=Ru&&n;if(a&&e.length>0&&!Jt.call(e,0))for(var u=0;u<e.length;++u)i.push(String(u));if(o&&e.length>0)for(var c=0;c<e.length;++c)i.push(String(c));else for(var f in e)!(s&&f==="prototype")&&Jt.call(e,f)&&i.push(String(f));if(Eu)for(var l=Lu(e),p=0;p<Qt.length;++p)!(l&&Qt[p]==="constructor")&&Jt.call(e,Qt[p])&&i.push(Qt[p]);return i});var Jt,lo,Cu,fo,Eu,Ru,Qt,Wr,Iu,ju,Lu;Mu.exports=Nu});var Bu=A((_O,$u)=>{"use strict";var ay=Array.prototype.slice,iy=co(),Fu=Object.keys,Vr=Fu?function(e){return Fu(e)}:Du(),Uu=Object.keys;Vr.shim=function(){if(Object.keys){var e=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);e||(Object.keys=function(n){return iy(n)?Uu(ay.call(n)):Uu(n)})}else Object.keys=Vr;return Object.keys||Vr};$u.exports=Vr});var go=A((AO,qu)=>{"use strict";var sy=se(),po=sy("%Object.defineProperty%",!0),mo=function(){if(po)try{return po({},"a",{value:1}),!0}catch{return!1}return!1};mo.hasArrayLengthDefineBug=function(){if(!mo())return null;try{return po([],"length",{value:1}).length!==1}catch{return!0}};qu.exports=mo});var ho=A((SO,Ku)=>{"use strict";var uy=Bu(),cy=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",ly=Object.prototype.toString,fy=Array.prototype.concat,Gu=Object.defineProperty,py=function(t){return typeof t=="function"&&ly.call(t)==="[object Function]"},dy=go()(),Wu=Gu&&dy,my=function(t,e,r,n){e in t&&(!py(n)||!n())||(Wu?Gu(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},Vu=function(t,e){var r=arguments.length>2?arguments[2]:{},n=uy(e);cy&&(n=fy.call(n,Object.getOwnPropertySymbols(e)));for(var o=0;o<n.length;o+=1)my(t,n[o],e[n[o]],r[n[o]])};Vu.supportsDescriptors=!!Wu;Ku.exports=Vu});var Kr=A((PO,zu)=>{"use strict";zu.exports=function(){if(typeof Promise!="function")throw new TypeError("`Promise.prototype.finally` requires a global `Promise` be available.")}});var Yu=A((TO,Qu)=>{"use strict";var Ju=Function.prototype.toString,Pt=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,vo,zr;if(typeof Pt=="function"&&typeof Object.defineProperty=="function")try{vo=Object.defineProperty({},"length",{get:function(){throw zr}}),zr={},Pt(function(){throw 42},null,vo)}catch(t){t!==zr&&(Pt=null)}else Pt=null;var gy=/^\s*class\b/,bo=function(e){try{var r=Ju.call(e);return gy.test(r)}catch{return!1}},yo=function(e){try{return bo(e)?!1:(Ju.call(e),!0)}catch{return!1}},Hr=Object.prototype.toString,hy="[object Object]",yy="[object Function]",vy="[object GeneratorFunction]",by="[object HTMLAllCollection]",xy="[object HTML document.all class]",wy="[object HTMLCollection]",_y=typeof Symbol=="function"&&!!Symbol.toStringTag,Ay=!(0 in[,]),xo=function(){return!1};typeof document=="object"&&(Hu=document.all,Hr.call(Hu)===Hr.call(document.all)&&(xo=function(e){if((Ay||!e)&&(typeof e>"u"||typeof e=="object"))try{var r=Hr.call(e);return(r===by||r===xy||r===wy||r===hy)&&e("")==null}catch{}return!1}));var Hu;Qu.exports=Pt?function(e){if(xo(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{Pt(e,null,vo)}catch(r){if(r!==zr)return!1}return!bo(e)&&yo(e)}:function(e){if(xo(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(_y)return yo(e);if(bo(e))return!1;var r=Hr.call(e);return r!==yy&&r!==vy&&!/^\[object HTML/.test(r)?!1:yo(e)}});var wo=A((OO,Zu)=>{"use strict";Zu.exports=Yu()});var ec=A((kO,Xu)=>{"use strict";Xu.exports=se()});var rc=A((CO,tc)=>{"use strict";var Sy=se(),Py=Be(),Ty=Sy("%TypeError%");tc.exports=function(e,r){if(e.Type(r)!=="Object")return!1;var n={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var o in r)if(Py(r,o)&&!n[o])return!1;if(e.IsDataDescriptor(r)&&e.IsAccessorDescriptor(r))throw new Ty("Property Descriptors may not be both accessor and data descriptors");return!0}});var _o=A((EO,ac)=>{"use strict";var nc=se(),oc=uo(),Oy=oc(nc("String.prototype.indexOf"));ac.exports=function(e,r){var n=nc(e,!!r);return typeof n=="function"&&Oy(e,".prototype.")>-1?oc(n):n}});var uc=A((RO,sc)=>{"use strict";var ky=se(),ic=ky("%Array%"),Cy=!ic.isArray&&_o()("Object.prototype.toString");sc.exports=ic.isArray||function(e){return Cy(e)==="[object Array]"}});var dc=A((IO,pc)=>{"use strict";var lc=go(),Ey=se(),cc=lc()&&Ey("%Object.defineProperty%",!0),fc=lc.hasArrayLengthDefineBug(),Ry=fc&&uc(),Iy=_o(),jy=Iy("Object.prototype.propertyIsEnumerable");pc.exports=function(e,r,n,o,a,i){if(!cc){if(!e(i)||!i["[[Configurable]]"]||!i["[[Writable]]"]||a in o&&jy(o,a)!==!!i["[[Enumerable]]"])return!1;var s=i["[[Value]]"];return o[a]=s,r(o[a],s)}return fc&&a==="length"&&"[[Value]]"in i&&Ry(o)&&o.length!==i["[[Value]]"]?(o.length=i["[[Value]]"],o.length===i["[[Value]]"]):(cc(o,a,n(i)),!0)}});var hc=A((jO,gc)=>{"use strict";var mc=Be();gc.exports=function(e){return mc(e,"[[StartIndex]]")&&mc(e,"[[EndIndex]]")&&e["[[StartIndex]]"]>=0&&e["[[EndIndex]]"]>=e["[[StartIndex]]"]&&String(parseInt(e["[[StartIndex]]"],10))===String(e["[[StartIndex]]"])&&String(parseInt(e["[[EndIndex]]"],10))===String(e["[[EndIndex]]"])}});var Qr=A((LO,bc)=>{"use strict";var yc=se(),vc=yc("%TypeError%"),Ly=yc("%SyntaxError%"),Jr=Be(),Ny=hc(),My={"Property Descriptor":function(e){var r={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in e)if(Jr(e,n)&&!r[n])return!1;var o=Jr(e,"[[Value]]"),a=Jr(e,"[[Get]]")||Jr(e,"[[Set]]");if(o&&a)throw new vc("Property Descriptors may not be both accessor and data descriptors");return!0},"Match Record":Ny};bc.exports=function(e,r,n,o){var a=My[r];if(typeof a!="function")throw new Ly("unknown record type: "+r);if(e(o)!=="Object"||!a(o))throw new vc(n+" must be a "+r)}});var wc=A((NO,xc)=>{"use strict";xc.exports=function(e){if(typeof e>"u")return e;var r={};return"[[Value]]"in e&&(r.value=e["[[Value]]"]),"[[Writable]]"in e&&(r.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(r.get=e["[[Get]]"]),"[[Set]]"in e&&(r.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(r.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(r.configurable=!!e["[[Configurable]]"]),r}});var Ac=A((MO,_c)=>{"use strict";_c.exports=function(e){if(e===null)return"Null";if(typeof e>"u")return"Undefined";if(typeof e=="function"||typeof e=="object")return"Object";if(typeof e=="number")return"Number";if(typeof e=="boolean")return"Boolean";if(typeof e=="string")return"String"}});var Ge=A((DO,Sc)=>{"use strict";var Dy=Ac();Sc.exports=function(e){return typeof e=="symbol"?"Symbol":typeof e=="bigint"?"BigInt":Dy(e)}});var Tc=A((FO,Pc)=>{"use strict";var Fy=Qr(),Uy=wc(),$y=Ge();Pc.exports=function(e){return typeof e<"u"&&Fy($y,"Property Descriptor","Desc",e),Uy(e)}});var Cc=A((UO,kc)=>{"use strict";var Oc=Be(),By=Qr(),qy=Ge();kc.exports=function(e){return!(typeof e>"u"||(By(qy,"Property Descriptor","Desc",e),!Oc(e,"[[Get]]")&&!Oc(e,"[[Set]]")))}});var Ic=A(($O,Rc)=>{"use strict";var Ec=Be(),Gy=Qr(),Wy=Ge();Rc.exports=function(e){return!(typeof e>"u"||(Gy(Wy,"Property Descriptor","Desc",e),!Ec(e,"[[Value]]")&&!Ec(e,"[[Writable]]")))}});var Lc=A((BO,jc)=>{"use strict";jc.exports=function(e){return typeof e=="string"||typeof e=="symbol"}});var Mc=A((qO,Nc)=>{"use strict";Nc.exports=Number.isNaN||function(e){return e!==e}});var Uc=A((GO,Fc)=>{"use strict";var Dc=Mc();Fc.exports=function(e,r){return e===r?e===0?1/e===1/r:!0:Dc(e)&&Dc(r)}});var Bc=A((WO,$c)=>{"use strict";$c.exports=function(e){return!!e}});var Wc=A((VO,Gc)=>{"use strict";var ye=Be(),Vy=se(),Yr=Vy("%TypeError%"),Ky=Ge(),Ao=Bc(),qc=wo();Gc.exports=function(e){if(Ky(e)!=="Object")throw new Yr("ToPropertyDescriptor requires an object");var r={};if(ye(e,"enumerable")&&(r["[[Enumerable]]"]=Ao(e.enumerable)),ye(e,"configurable")&&(r["[[Configurable]]"]=Ao(e.configurable)),ye(e,"value")&&(r["[[Value]]"]=e.value),ye(e,"writable")&&(r["[[Writable]]"]=Ao(e.writable)),ye(e,"get")){var n=e.get;if(typeof n<"u"&&!qc(n))throw new Yr("getter must be a function");r["[[Get]]"]=n}if(ye(e,"set")){var o=e.set;if(typeof o<"u"&&!qc(o))throw new Yr("setter must be a function");r["[[Set]]"]=o}if((ye(r,"[[Get]]")||ye(r,"[[Set]]"))&&(ye(r,"[[Value]]")||ye(r,"[[Writable]]")))throw new Yr("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return r}});var Hc=A((KO,zc)=>{"use strict";var zy=se(),So=zy("%TypeError%"),Vc=rc(),Hy=dc(),Jy=Tc(),Kc=Cc(),Po=Ic(),Qy=Lc(),Yy=Uc(),Zy=Wc(),To=Ge();zc.exports=function(e,r,n){if(To(e)!=="Object")throw new So("Assertion failed: Type(O) is not Object");if(!Qy(r))throw new So("Assertion failed: IsPropertyKey(P) is not true");var o=Vc({Type:To,IsDataDescriptor:Po,IsAccessorDescriptor:Kc},n)?n:Zy(n);if(!Vc({Type:To,IsDataDescriptor:Po,IsAccessorDescriptor:Kc},o))throw new So("Assertion failed: Desc is not a valid Property Descriptor");return Hy(Po,Yy,Jy,e,r,o)}});var Qc=A((zO,Co)=>{"use strict";var Xy=ec(),Jc=Xy("%Reflect.construct%",!0),Zr=Hc();try{Zr({},"",{"[[Get]]":function(){}})}catch{Zr=null}Zr&&Jc?(Oo={},ko={},Zr(ko,"length",{"[[Get]]":function(){throw Oo},"[[Enumerable]]":!0}),Co.exports=function(e){try{Jc(e,ko)}catch(r){return r===Oo}}):Co.exports=function(e){return typeof e=="function"&&!!e.prototype};var Oo,ko});var tl=A((HO,el)=>{"use strict";var Xc=se(),Yc=Xc("%Symbol.species%",!0),Eo=Xc("%TypeError%"),ev=Qc(),Zc=Ge();el.exports=function(e,r){if(Zc(e)!=="Object")throw new Eo("Assertion failed: Type(O) is not Object");var n=e.constructor;if(typeof n>"u")return r;if(Zc(n)!=="Object")throw new Eo("O.constructor is not an Object");var o=Yc?n[Yc]:void 0;if(o==null)return r;if(ev(o))return o;throw new Eo("no constructor found")}});var jo=A((JO,nl)=>{"use strict";var tv=Kr();tv();var rv=wo(),nv=tl(),ov=Ge(),rl=function(e,r){return new e(function(n){n(r)})},av=Promise,iv=function(e,r){return function(n){var o=r(),a=rl(e,o),i=function(){return n};return a.then(i)}},sv=function(e,r){return function(n){var o=r(),a=rl(e,o),i=function(){throw n};return a.then(i)}},Io=function(e){var r=this;if(ov(r)!=="Object")throw new TypeError("receiver is not an Object");var n=nv(r,av),o=e,a=e;return rv(e)&&(o=iv(n,e),a=sv(n,e)),r.then(o,a)};Object.getOwnPropertyDescriptor&&(Ro=Object.getOwnPropertyDescriptor(Io,"name"),Ro&&Ro.configurable&&Object.defineProperty(Io,"name",{configurable:!0,value:"finally"}));var Ro;nl.exports=Io});var Lo=A((QO,ol)=>{"use strict";var uv=Kr(),cv=jo();ol.exports=function(){return uv(),typeof Promise.prototype.finally=="function"?Promise.prototype.finally:cv}});var il=A((YO,al)=>{"use strict";var lv=Kr(),fv=Lo(),pv=ho();al.exports=function(){lv();var e=fv();return pv(Promise.prototype,{finally:e},{finally:function(){return Promise.prototype.finally!==e}}),e}});var ll=A((ZO,cl)=>{"use strict";var dv=uo(),mv=ho(),gv=jo(),sl=Lo(),hv=il(),ul=dv(sl());mv(ul,{getPolyfill:sl,implementation:gv,shim:hv});cl.exports=ul});var pl=A((e1,fl)=>{var yv=no(),vv=ll();fl.exports=class{constructor(){this._items=new Map}create(e,r,n){return this._rejectExistingRequest(e),this._createNewRequest(e,r,n)}resolve(e,r){e&&this._items.has(e)&&this._items.get(e).resolve(r)}rejectAll(e){this._items.forEach(r=>r.isPending?r.reject(e):null)}_rejectExistingRequest(e){let r=this._items.get(e);r&&r.isPending&&r.reject(new Error(`WebSocket request is replaced, id: ${e}`))}_createNewRequest(e,r,n){let o=new yv({timeout:n,timeoutReason:`WebSocket request was rejected by timeout (${n} ms). RequestId: ${e}`});return this._items.set(e,o),vv(o.call(r),()=>this._deleteRequest(e,o))}_deleteRequest(e,r){this._items.get(e)===r&&this._items.delete(e)}}});var ml=A((t1,dl)=>{dl.exports={createWebSocket:t=>new WebSocket(t),packMessage:null,unpackMessage:null,attachRequestId:null,extractRequestId:null,extractMessageData:t=>t.data,timeout:0,connectionTimeout:0}});var gl=A(No=>{No.throwIf=(t,e)=>{if(t)throw new Error(e)};No.isPromise=t=>t&&typeof t.then=="function"});var bl=A((n1,vl)=>{var We=eu(),hl=no(),{PromisedMap:bv}=uu(),xv=pl(),yl=ml(),{throwIf:Xr,isPromise:wv}=gl(),en={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Mo=class{constructor(e,r){this._assertOptions(r),this._url=e,this._options=Object.assign({},yl,r),this._requests=new xv,this._promisedMap=new bv,this._ws=null,this._wsSubscription=null,this._createOpeningController(),this._createClosingController(),this._createChannels()}get ws(){return this._ws}get url(){return this._url}get isOpening(){return!!(this._ws&&this._ws.readyState===en.CONNECTING)}get isOpened(){return!!(this._ws&&this._ws.readyState===en.OPEN)}get isClosing(){return!!(this._ws&&this._ws.readyState===en.CLOSING)}get isClosed(){return!this._ws||this._ws.readyState===en.CLOSED}get onOpen(){return this._onOpen}get onSend(){return this._onSend}get onMessage(){return this._onMessage}get onUnpackedMessage(){return this._onUnpackedMessage}get onResponse(){return this._onResponse}get onClose(){return this._onClose}get onError(){return this._onError}open(){return this.isClosing?Promise.reject(new Error("Can't open WebSocket while closing.")):this.isOpened?this._opening.promise:this._opening.call(()=>{this._opening.promise.catch(e=>this._cleanup(e)),this._createWS()})}sendRequest(e,r={}){let n=r.requestId||`${Math.random()}`,o=r.timeout!==void 0?r.timeout:this._options.timeout;return this._requests.create(n,()=>{this._assertRequestIdHandlers();let a=this._options.attachRequestId(e,n);this.sendPacked(a)},o)}sendPacked(e){this._assertPackingHandlers();let r=this._options.packMessage(e);this.send(r)}send(e){Xr(!this.isOpened,"Can't send data because WebSocket is not opened."),this._ws.send(e),this._onSend.dispatchAsync(e)}waitUnpackedMessage(e,r={}){return Xr(typeof e!="function",`Predicate must be a function, got ${typeof e}`),r.timeout&&setTimeout(()=>{if(this._promisedMap.has(e)){let n=r.timeoutError||new Error("Timeout");this._promisedMap.reject(e,n)}},r.timeout),this._promisedMap.set(e)}close(e,r){return this.isClosed?Promise.resolve(this._closing.value):this._closing.call(()=>this._ws.close(e,r))}removeAllListeners(){this._onOpen.removeAllListeners(),this._onMessage.removeAllListeners(),this._onUnpackedMessage.removeAllListeners(),this._onResponse.removeAllListeners(),this._onSend.removeAllListeners(),this._onClose.removeAllListeners(),this._onError.removeAllListeners()}_createOpeningController(){let e=this._options.connectionTimeout||this._options.timeout;this._opening=new hl({timeout:e,timeoutReason:`Can't open WebSocket within allowed timeout: ${e} ms.`})}_createClosingController(){let e=this._options.timeout;this._closing=new hl({timeout:e,timeoutReason:`Can't close WebSocket within allowed timeout: ${e} ms.`})}_createChannels(){this._onOpen=new We,this._onMessage=new We,this._onUnpackedMessage=new We,this._onResponse=new We,this._onSend=new We,this._onClose=new We,this._onError=new We}_createWS(){this._ws=this._options.createWebSocket(this._url),this._wsSubscription=new We.Subscription([{channel:this._ws,event:"open",listener:e=>this._handleOpen(e)},{channel:this._ws,event:"message",listener:e=>this._handleMessage(e)},{channel:this._ws,event:"error",listener:e=>this._handleError(e)},{channel:this._ws,event:"close",listener:e=>this._handleClose(e)}]).on()}_handleOpen(e){this._onOpen.dispatchAsync(e),this._opening.resolve(e)}_handleMessage(e){let r=this._options.extractMessageData(e);this._onMessage.dispatchAsync(r),this._tryUnpack(r)}_tryUnpack(e){this._options.unpackMessage&&(e=this._options.unpackMessage(e),wv(e)?e.then(r=>this._handleUnpackedData(r)):this._handleUnpackedData(e))}_handleUnpackedData(e){e!==void 0&&(this._onUnpackedMessage.dispatchAsync(e),this._tryHandleResponse(e)),this._tryHandleWaitingMessage(e)}_tryHandleResponse(e){if(this._options.extractRequestId){let r=this._options.extractRequestId(e);r&&(this._onResponse.dispatchAsync(e,r),this._requests.resolve(r,e))}}_tryHandleWaitingMessage(e){this._promisedMap.forEach((r,n)=>{let o=!1;try{o=n(e)}catch(a){this._promisedMap.reject(n,a);return}o&&this._promisedMap.resolve(n,e)})}_handleError(e){this._onError.dispatchAsync(e)}_handleClose(e){this._onClose.dispatchAsync(e),this._closing.resolve(e);let r=new Error(`WebSocket closed with reason: ${e.reason} (${e.code}).`);this._opening.isPending&&this._opening.reject(r),this._cleanup(r)}_cleanupWS(){this._wsSubscription&&(this._wsSubscription.off(),this._wsSubscription=null),this._ws=null}_cleanup(e){this._cleanupWS(),this._requests.rejectAll(e)}_assertOptions(e){Object.keys(e||{}).forEach(r=>{if(!yl.hasOwnProperty(r))throw new Error(`Unknown option: ${r}`)})}_assertPackingHandlers(){let{packMessage:e,unpackMessage:r}=this._options;Xr(!e||!r,"Please define 'options.packMessage / options.unpackMessage' for sending packed messages.")}_assertRequestIdHandlers(){let{attachRequestId:e,extractRequestId:r}=this._options;Xr(!e||!r,"Please define 'options.attachRequestId / options.extractRequestId' for sending requests.")}};vl.exports=Mo});var P=U(K());var zl=typeof global=="object"&&global&&global.Object===Object&&global,nr=zl;var Hl=typeof self=="object"&&self&&self.Object===Object&&self,Jl=nr||Hl||Function("return this")(),I=Jl;var Ql=I.Symbol,rt=Ql;var Zo=Object.prototype,Yl=Zo.hasOwnProperty,Zl=Zo.toString,Et=rt?rt.toStringTag:void 0;function Xl(t){var e=Yl.call(t,Et),r=t[Et];try{t[Et]=void 0;var n=!0}catch{}var o=Zl.call(t);return n&&(e?t[Et]=r:delete t[Et]),o}var Xo=Xl;var ef=Object.prototype,tf=ef.toString;function rf(t){return tf.call(t)}var ea=rf;var nf="[object Null]",of="[object Undefined]",ta=rt?rt.toStringTag:void 0;function af(t){return t==null?t===void 0?of:nf:ta&&ta in Object(t)?Xo(t):ea(t)}var z=af;function sf(t){return t!=null&&typeof t=="object"}var Q=sf;var uf="[object Symbol]";function cf(t){return typeof t=="symbol"||Q(t)&&z(t)==uf}var ra=cf;var lf=Array.isArray,be=lf;var ff=/\s/;function pf(t){for(var e=t.length;e--&&ff.test(t.charAt(e)););return e}var na=pf;var df=/^\s+/;function mf(t){return t&&t.slice(0,na(t)+1).replace(df,"")}var oa=mf;function gf(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var D=gf;var aa=0/0,hf=/^[-+]0x[0-9a-f]+$/i,yf=/^0b[01]+$/i,vf=/^0o[0-7]+$/i,bf=parseInt;function xf(t){if(typeof t=="number")return t;if(ra(t))return aa;if(D(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=D(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=oa(t);var r=yf.test(t);return r||vf.test(t)?bf(t.slice(2),r?2:8):hf.test(t)?aa:+t}var Rt=xf;var ia=1/0,wf=17976931348623157e292;function _f(t){if(!t)return t===0?t:0;if(t=Rt(t),t===ia||t===-ia){var e=t<0?-1:1;return e*wf}return t===t?t:0}var dn=_f;function Af(t){return t}var or=Af;var Sf="[object AsyncFunction]",Pf="[object Function]",Tf="[object GeneratorFunction]",Of="[object Proxy]";function kf(t){if(!D(t))return!1;var e=z(t);return e==Pf||e==Tf||e==Sf||e==Of}var nt=kf;var Cf=I["__core-js_shared__"],ar=Cf;var sa=function(){var t=/[^.]+$/.exec(ar&&ar.keys&&ar.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ef(t){return!!sa&&sa in t}var ua=Ef;var Rf=Function.prototype,If=Rf.toString;function jf(t){if(t!=null){try{return If.call(t)}catch{}try{return t+""}catch{}}return""}var xe=jf;var Lf=/[\\^$.*+?()[\]{}|]/g,Nf=/^\[object .+?Constructor\]$/,Mf=Function.prototype,Df=Object.prototype,Ff=Mf.toString,Uf=Df.hasOwnProperty,$f=RegExp("^"+Ff.call(Uf).replace(Lf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Bf(t){if(!D(t)||ua(t))return!1;var e=nt(t)?$f:Nf;return e.test(xe(t))}var ca=Bf;function qf(t,e){return t?.[e]}var la=qf;function Gf(t,e){var r=la(t,e);return ca(r)?r:void 0}var Y=Gf;var Wf=Y(I,"WeakMap"),ir=Wf;var fa=Object.create,Vf=function(){function t(){}return function(e){if(!D(e))return{};if(fa)return fa(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),pa=Vf;function Kf(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var da=Kf;function zf(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var ma=zf;var Hf=800,Jf=16,Qf=Date.now;function Yf(t){var e=0,r=0;return function(){var n=Qf(),o=Jf-(n-r);if(r=n,o>0){if(++e>=Hf)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var ga=Yf;function Zf(t){return function(){return t}}var ha=Zf;var Xf=function(){try{var t=Y(Object,"defineProperty");return t({},"",{}),t}catch{}}(),ot=Xf;var ep=ot?function(t,e){return ot(t,"toString",{configurable:!0,enumerable:!1,value:ha(e),writable:!0})}:or,ya=ep;var tp=ga(ya),va=tp;var rp=9007199254740991,np=/^(?:0|[1-9]\d*)$/;function op(t,e){var r=typeof t;return e=e??rp,!!e&&(r=="number"||r!="symbol"&&np.test(t))&&t>-1&&t%1==0&&t<e}var sr=op;function ap(t,e,r){e=="__proto__"&&ot?ot(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var at=ap;function ip(t,e){return t===e||t!==t&&e!==e}var Pe=ip;var sp=Object.prototype,up=sp.hasOwnProperty;function cp(t,e,r){var n=t[e];(!(up.call(t,e)&&Pe(n,r))||r===void 0&&!(e in t))&&at(t,e,r)}var ba=cp;function lp(t,e,r,n){var o=!r;r||(r={});for(var a=-1,i=e.length;++a<i;){var s=e[a],u=n?n(r[s],t[s],s,r,t):void 0;u===void 0&&(u=t[s]),o?at(r,s,u):ba(r,s,u)}return r}var xa=lp;var wa=Math.max;function fp(t,e,r){return e=wa(e===void 0?t.length-1:e,0),function(){for(var n=arguments,o=-1,a=wa(n.length-e,0),i=Array(a);++o<a;)i[o]=n[e+o];o=-1;for(var s=Array(e+1);++o<e;)s[o]=n[o];return s[e]=r(i),da(t,this,s)}}var _a=fp;function pp(t,e){return va(_a(t,e,or),t+"")}var Aa=pp;var dp=9007199254740991;function mp(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=dp}var ur=mp;function gp(t){return t!=null&&ur(t.length)&&!nt(t)}var Te=gp;function hp(t,e,r){if(!D(r))return!1;var n=typeof e;return(n=="number"?Te(r)&&sr(e,r.length):n=="string"&&e in r)?Pe(r[e],t):!1}var cr=hp;function yp(t){return Aa(function(e,r){var n=-1,o=r.length,a=o>1?r[o-1]:void 0,i=o>2?r[2]:void 0;for(a=t.length>3&&typeof a=="function"?(o--,a):void 0,i&&cr(r[0],r[1],i)&&(a=o<3?void 0:a,o=1),e=Object(e);++n<o;){var s=r[n];s&&t(e,s,n,a)}return e})}var Sa=yp;var vp=Object.prototype;function bp(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||vp;return t===r}var Oe=bp;function xp(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Pa=xp;var wp="[object Arguments]";function _p(t){return Q(t)&&z(t)==wp}var mn=_p;var Ta=Object.prototype,Ap=Ta.hasOwnProperty,Sp=Ta.propertyIsEnumerable,Pp=mn(function(){return arguments}())?mn:function(t){return Q(t)&&Ap.call(t,"callee")&&!Sp.call(t,"callee")},Ve=Pp;function Tp(){return!1}var Oa=Tp;var Ea=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ka=Ea&&typeof module=="object"&&module&&!module.nodeType&&module,Op=ka&&ka.exports===Ea,Ca=Op?I.Buffer:void 0,kp=Ca?Ca.isBuffer:void 0,Cp=kp||Oa,it=Cp;var Ep="[object Arguments]",Rp="[object Array]",Ip="[object Boolean]",jp="[object Date]",Lp="[object Error]",Np="[object Function]",Mp="[object Map]",Dp="[object Number]",Fp="[object Object]",Up="[object RegExp]",$p="[object Set]",Bp="[object String]",qp="[object WeakMap]",Gp="[object ArrayBuffer]",Wp="[object DataView]",Vp="[object Float32Array]",Kp="[object Float64Array]",zp="[object Int8Array]",Hp="[object Int16Array]",Jp="[object Int32Array]",Qp="[object Uint8Array]",Yp="[object Uint8ClampedArray]",Zp="[object Uint16Array]",Xp="[object Uint32Array]",E={};E[Vp]=E[Kp]=E[zp]=E[Hp]=E[Jp]=E[Qp]=E[Yp]=E[Zp]=E[Xp]=!0;E[Ep]=E[Rp]=E[Gp]=E[Ip]=E[Wp]=E[jp]=E[Lp]=E[Np]=E[Mp]=E[Dp]=E[Fp]=E[Up]=E[$p]=E[Bp]=E[qp]=!1;function ed(t){return Q(t)&&ur(t.length)&&!!E[z(t)]}var Ra=ed;function td(t){return function(e){return t(e)}}var Ia=td;var ja=typeof exports=="object"&&exports&&!exports.nodeType&&exports,It=ja&&typeof module=="object"&&module&&!module.nodeType&&module,rd=It&&It.exports===ja,gn=rd&&nr.process,nd=function(){try{var t=It&&It.require&&It.require("util").types;return t||gn&&gn.binding&&gn.binding("util")}catch{}}(),hn=nd;var La=hn&&hn.isTypedArray,od=La?Ia(La):Ra,st=od;var ad=Object.prototype,id=ad.hasOwnProperty;function sd(t,e){var r=be(t),n=!r&&Ve(t),o=!r&&!n&&it(t),a=!r&&!n&&!o&&st(t),i=r||n||o||a,s=i?Pa(t.length,String):[],u=s.length;for(var c in t)(e||id.call(t,c))&&!(i&&(c=="length"||o&&(c=="offset"||c=="parent")||a&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||sr(c,u)))&&s.push(c);return s}var Na=sd;function ud(t,e){return function(r){return t(e(r))}}var lr=ud;var cd=lr(Object.keys,Object),Ma=cd;var ld=Object.prototype,fd=ld.hasOwnProperty;function pd(t){if(!Oe(t))return Ma(t);var e=[];for(var r in Object(t))fd.call(t,r)&&r!="constructor"&&e.push(r);return e}var Da=pd;function dd(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Fa=dd;var md=Object.prototype,gd=md.hasOwnProperty;function hd(t){if(!D(t))return Fa(t);var e=Oe(t),r=[];for(var n in t)n=="constructor"&&(e||!gd.call(t,n))||r.push(n);return r}var Ua=hd;function yd(t){return Te(t)?Na(t,!0):Ua(t)}var fr=yd;var vd=Y(Object,"create"),we=vd;function bd(){this.__data__=we?we(null):{},this.size=0}var $a=bd;function xd(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Ba=xd;var wd="__lodash_hash_undefined__",_d=Object.prototype,Ad=_d.hasOwnProperty;function Sd(t){var e=this.__data__;if(we){var r=e[t];return r===wd?void 0:r}return Ad.call(e,t)?e[t]:void 0}var qa=Sd;var Pd=Object.prototype,Td=Pd.hasOwnProperty;function Od(t){var e=this.__data__;return we?e[t]!==void 0:Td.call(e,t)}var Ga=Od;var kd="__lodash_hash_undefined__";function Cd(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=we&&e===void 0?kd:e,this}var Wa=Cd;function ut(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ut.prototype.clear=$a;ut.prototype.delete=Ba;ut.prototype.get=qa;ut.prototype.has=Ga;ut.prototype.set=Wa;var yn=ut;function Ed(){this.__data__=[],this.size=0}var Va=Ed;function Rd(t,e){for(var r=t.length;r--;)if(Pe(t[r][0],e))return r;return-1}var ke=Rd;var Id=Array.prototype,jd=Id.splice;function Ld(t){var e=this.__data__,r=ke(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():jd.call(e,r,1),--this.size,!0}var Ka=Ld;function Nd(t){var e=this.__data__,r=ke(e,t);return r<0?void 0:e[r][1]}var za=Nd;function Md(t){return ke(this.__data__,t)>-1}var Ha=Md;function Dd(t,e){var r=this.__data__,n=ke(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}var Ja=Dd;function ct(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ct.prototype.clear=Va;ct.prototype.delete=Ka;ct.prototype.get=za;ct.prototype.has=Ha;ct.prototype.set=Ja;var Ce=ct;var Fd=Y(I,"Map"),Ee=Fd;function Ud(){this.size=0,this.__data__={hash:new yn,map:new(Ee||Ce),string:new yn}}var Qa=Ud;function $d(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Ya=$d;function Bd(t,e){var r=t.__data__;return Ya(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Re=Bd;function qd(t){var e=Re(this,t).delete(t);return this.size-=e?1:0,e}var Za=qd;function Gd(t){return Re(this,t).get(t)}var Xa=Gd;function Wd(t){return Re(this,t).has(t)}var ei=Wd;function Vd(t,e){var r=Re(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}var ti=Vd;function lt(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}lt.prototype.clear=Qa;lt.prototype.delete=Za;lt.prototype.get=Xa;lt.prototype.has=ei;lt.prototype.set=ti;var ri=lt;var Kd=lr(Object.getPrototypeOf,Object),pr=Kd;var zd="[object Object]",Hd=Function.prototype,Jd=Object.prototype,ni=Hd.toString,Qd=Jd.hasOwnProperty,Yd=ni.call(Object);function Zd(t){if(!Q(t)||z(t)!=zd)return!1;var e=pr(t);if(e===null)return!0;var r=Qd.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&ni.call(r)==Yd}var oi=Zd;function Xd(){this.__data__=new Ce,this.size=0}var ai=Xd;function em(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var ii=em;function tm(t){return this.__data__.get(t)}var si=tm;function rm(t){return this.__data__.has(t)}var ui=rm;var nm=200;function om(t,e){var r=this.__data__;if(r instanceof Ce){var n=r.__data__;if(!Ee||n.length<nm-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new ri(n)}return r.set(t,e),this.size=r.size,this}var ci=om;function ft(t){var e=this.__data__=new Ce(t);this.size=e.size}ft.prototype.clear=ai;ft.prototype.delete=ii;ft.prototype.get=si;ft.prototype.has=ui;ft.prototype.set=ci;var li=ft;var mi=typeof exports=="object"&&exports&&!exports.nodeType&&exports,fi=mi&&typeof module=="object"&&module&&!module.nodeType&&module,am=fi&&fi.exports===mi,pi=am?I.Buffer:void 0,di=pi?pi.allocUnsafe:void 0;function im(t,e){if(e)return t.slice();var r=t.length,n=di?di(r):new t.constructor(r);return t.copy(n),n}var gi=im;var sm=Y(I,"DataView"),dr=sm;var um=Y(I,"Promise"),mr=um;var cm=Y(I,"Set"),gr=cm;var hi="[object Map]",lm="[object Object]",yi="[object Promise]",vi="[object Set]",bi="[object WeakMap]",xi="[object DataView]",fm=xe(dr),pm=xe(Ee),dm=xe(mr),mm=xe(gr),gm=xe(ir),Ke=z;(dr&&Ke(new dr(new ArrayBuffer(1)))!=xi||Ee&&Ke(new Ee)!=hi||mr&&Ke(mr.resolve())!=yi||gr&&Ke(new gr)!=vi||ir&&Ke(new ir)!=bi)&&(Ke=function(t){var e=z(t),r=e==lm?t.constructor:void 0,n=r?xe(r):"";if(n)switch(n){case fm:return xi;case pm:return hi;case dm:return yi;case mm:return vi;case gm:return bi}return e});var wi=Ke;var hm=I.Uint8Array,vn=hm;function ym(t){var e=new t.constructor(t.byteLength);return new vn(e).set(new vn(t)),e}var _i=ym;function vm(t,e){var r=e?_i(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Ai=vm;function bm(t){return typeof t.constructor=="function"&&!Oe(t)?pa(pr(t)):{}}var Si=bm;function xm(t){return function(e,r,n){for(var o=-1,a=Object(e),i=n(e),s=i.length;s--;){var u=i[t?s:++o];if(r(a[u],u,a)===!1)break}return e}}var Pi=xm;var wm=Pi(),Ti=wm;var _m=function(){return I.Date.now()},hr=_m;var Am="Expected a function",Sm=Math.max,Pm=Math.min;function Tm(t,e,r){var n,o,a,i,s,u,c=0,f=!1,l=!1,p=!0;if(typeof t!="function")throw new TypeError(Am);e=Rt(e)||0,D(r)&&(f=!!r.leading,l="maxWait"in r,a=l?Sm(Rt(r.maxWait)||0,e):a,p="trailing"in r?!!r.trailing:p);function d(x){var S=n,C=o;return n=o=void 0,c=x,i=t.apply(C,S),i}function y(x){return c=x,s=setTimeout(m,e),f?d(x):i}function w(x){var S=x-u,C=x-c,R=e-S;return l?Pm(R,a-C):R}function b(x){var S=x-u,C=x-c;return u===void 0||S>=e||S<0||l&&C>=a}function m(){var x=hr();if(b(x))return h(x);s=setTimeout(m,w(x))}function h(x){return s=void 0,p&&n?d(x):(n=o=void 0,i)}function O(){s!==void 0&&clearTimeout(s),c=0,n=u=o=s=void 0}function g(){return s===void 0?i:h(hr())}function v(){var x=hr(),S=b(x);if(n=arguments,o=this,u=x,S){if(s===void 0)return y(u);if(l)return clearTimeout(s),s=setTimeout(m,e),d(u)}return s===void 0&&(s=setTimeout(m,e)),i}return v.cancel=O,v.flush=g,v}var fe=Tm;function Om(t,e,r){(r!==void 0&&!Pe(t[e],r)||r===void 0&&!(e in t))&&at(t,e,r)}var jt=Om;function km(t){return Q(t)&&Te(t)}var Oi=km;function Cm(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Lt=Cm;function Em(t){return xa(t,fr(t))}var ki=Em;function Rm(t,e,r,n,o,a,i){var s=Lt(t,r),u=Lt(e,r),c=i.get(u);if(c){jt(t,r,c);return}var f=a?a(s,u,r+"",t,e,i):void 0,l=f===void 0;if(l){var p=be(u),d=!p&&it(u),y=!p&&!d&&st(u);f=u,p||d||y?be(s)?f=s:Oi(s)?f=ma(s):d?(l=!1,f=gi(u,!0)):y?(l=!1,f=Ai(u,!0)):f=[]:oi(u)||Ve(u)?(f=s,Ve(s)?f=ki(s):(!D(s)||nt(s))&&(f=Si(u))):l=!1}l&&(i.set(u,f),o(f,u,n,a,i),i.delete(u)),jt(t,r,f)}var Ci=Rm;function Ei(t,e,r,n,o){t!==e&&Ti(e,function(a,i){if(o||(o=new li),D(a))Ci(t,e,i,r,Ei,n,o);else{var s=n?n(Lt(t,i),a,i+"",t,e,o):void 0;s===void 0&&(s=a),jt(t,i,s)}},fr)}var Ri=Ei;var Im="[object String]";function jm(t){return typeof t=="string"||!be(t)&&Q(t)&&z(t)==Im}var pt=jm;var Lm="[object Map]",Nm="[object Set]",Mm=Object.prototype,Dm=Mm.hasOwnProperty;function Fm(t){if(t==null)return!0;if(Te(t)&&(be(t)||typeof t=="string"||typeof t.splice=="function"||it(t)||st(t)||Ve(t)))return!t.length;var e=wi(t);if(e==Lm||e==Nm)return!t.size;if(Oe(t))return!Da(t).length;for(var r in t)if(Dm.call(t,r))return!1;return!0}var Nt=Fm;var Um=Sa(function(t,e,r){Ri(t,e,r)}),bn=Um;var $m=Math.floor,Bm=Math.random;function qm(t,e){return t+$m(Bm()*(e-t+1))}var Ii=qm;var Gm=parseFloat,Wm=Math.min,Vm=Math.random;function Km(t,e,r){if(r&&typeof r!="boolean"&&cr(t,e,r)&&(e=r=void 0),r===void 0&&(typeof e=="boolean"?(r=e,e=void 0):typeof t=="boolean"&&(r=t,t=void 0)),t===void 0&&e===void 0?(t=0,e=1):(t=dn(t),e===void 0?(e=t,t=0):e=dn(e)),t>e){var n=t;t=e,e=n}if(r||t%1||e%1){var o=Vm();return Wm(t+o*(e-t+Gm("1e-"+((o+"").length-1))),e)}return Ii(t,e)}var Mt=Km;var Dt=U(K()),Li=!/ChatGPT/.test(Dt.default.runtime.getManifest().name);var ze=Dt.default.runtime.getManifest().version,xn="gpt-3.5-turbo",ji="https://gochitchat.ai",q={origin:ji,api:`${ji}/api`};var Ie=(_=>(_.English="en",_["Chinese(Simplified)"]="zh_CN",_["Chinese(Traditional)"]="zh_TW",_.Spanish="es",_.French="fr",_.Japanese="ja",_.German="de",_.Portuguese="pt",_.Arabic="ar",_.Russian="ru",_.Italian="it",_.Korean="ko",_.Hindi="hi",_.Dutch="nl",_.Polish="pl",_.Amharic="am",_.Bulgarian="bg",_.Bengali="bn",_.Catalan="ca",_.Czech="cs",_.Danish="da",_.Greek="el",_.Estonian="et",_.Persian="fa",_.Finnish="fi",_.Filipino="fil",_.Gujarati="gu",_.Hebrew="he",_.Croatian="hr",_.Hungarian="hu",_.Indonesian="id",_.Kannada="kn",_.Lithuanian="lt",_.Latvian="lv",_.Malayalam="ml",_.Marathi="mr",_.Malay="ms",_.Norwegian="no",_.Romanian="ro",_.Slovak="sk",_.Slovenian="sl",_.Serbian="sr",_.Swedish="sv",_.Swahili="sw",_.Tamil="ta",_.Telugu="te",_.Thai="th",_.Turkish="tr",_.Ukrainian="uk",_.Urdu="ur",_.Vietnamese="vi",_))(Ie||{}),zm={en:"English",zh_CN:"\u4E2D\u6587(\u7B80\u4F53)",zh_TW:"\u4E2D\u6587(\u7E41\u9AD4)",es:"Espa\xF1ol",fr:"Fran\xE7ais",ja:"\u65E5\u672C\u8A9E",de:"Deutsch",pt:"Portugu\xEAs",ar:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629",ru:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",it:"Italiano",ko:"\uD55C\uAD6D\uC5B4",hi:"\u0939\u093F\u0928\u094D\u0926\u0940",nl:"Nederlands",pl:"Polski",am:"\u12A0\u121B\u122D\u129B",bg:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",bn:"\u09AC\u09BE\u0982\u09B2\u09BE",ca:"Catal\xE0",cs:"\u010Ce\u0161tina",da:"Dansk",el:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",et:"Eesti",fa:"\u0641\u0627\u0631\u0633\u06CC",fi:"Suomi",fil:"Filipino",gu:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0",he:"\u05E2\u05D1\u05E8\u05D9\u05EA",hr:"Hrvatski",hu:"Magyar",id:"Indonesia",kn:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1",lt:"Lietuvi\u0173",lv:"Latvie\u0161u",ml:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02",mr:"\u092E\u0930\u093E\u0920\u0940",ms:"Bahasa Melayu",no:"Norsk",ro:"Rom\xE2n\u0103",sk:"Sloven\u010Dina",sl:"Sloven\u0161\u010Dina",sr:"\u0421\u0440\u043F\u0441\u043A\u0438",sv:"Svenska",sw:"Kiswahili",ta:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",te:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41",th:"\u0E44\u0E17\u0E22",tr:"T\xFCrk\xE7e",uk:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",ur:"\u0627\u0631\u062F\u0648",vi:"Ti\u1EBFng Vi\u1EC7t"},Ft=Object.entries(Ie).reduce((t,[e,r])=>(t[r]=e,t),{}),RS=Object.entries(Ie).map(([t,e])=>({label:t,value:e})),IS=Object.entries(zm).map(([t,e])=>({label:e,value:t}));var yr=[{id:"default",title:"Default",template:"Can you tell me something about $[keywords]? If possible, can you give me some links about it?   If $[keywords] is a code related question, please just write the code",canEdit:!1},{id:"list",title:"Keywords to Questions",template:'List 1 most popular question about "$[keywords]". Then, Answer this question. At last,  list another 4 questions.',canEdit:!1},{id:"suggest",title:"Get related keywords",template:"$[keywords] are my search keywords in Google. Please give me 5 sets of related keywords.",canEdit:!1}];async function vr(){let{provider:t="siderApi"}=await Dt.default.storage.local.get("provider"),e="provider:gpt3",r=await Dt.default.storage.local.get(e);return{provider:t,configs:{["gpt3"]:r[e]}}}var Ut=[{key:"summarize",title:"Summarize",template:"Summarize this for a second-grade student: ",visible:!0},{key:"similar-pages",title:"Similar pages",template:"Find 10 similar pages to the following content with link: "},{key:"grammar",title:"Grammar",template:"Correct this to standard English: "},{key:"explain",title:"Explain",template:"Explain the following content: "},{key:"explain-codes",title:"Explain Codes",template:"Explain the following codes: "},{key:"rewrite",title:"Rewrite",template:"Rewrite the following content: "},{key:"translate",title:"Translate",template:"Translate the following content to $[lang] language: "},{key:"qa",title:"Q&A",template:"Answer this question: "}];var je={pricing:`${q.origin}/pricing`,login:`${q.origin}/login`,myChats:`${q.origin}/mychats`,openaiChat:"https://chat.openai.com",openaiLogin:"https://platform.openai.com/login",openaiSignup:"https://platform.openai.com/signup",openaiApiKey:"https://platform.openai.com/account/api-keys",openaiApiSession:"https://chat.openai.com/api/auth/session",edgeStore:"https://microsoftedge.microsoft.com/addons/detail/sider-ai-sidebar/dhoenijjpgpeimemopealfcbiecgceod",chromeStoreReview:"https://chrome.google.com/webstore/detail/chatgpt-sidebar/difoiogjjojoaoomphldepapgpbgkhkb/reviews",chromeStore:"https://chrome.google.com/webstore/detail/chatgpt-sidebar/difoiogjjojoaoomphldepapgpbgkhkb",weChatQrCode:"https://gochitchat.ai/resource/weixin/qrcode.jpeg",producthuntPromoteApi:"https://gochitchat.ai/resource/promotion/extension-promote.json"};var Ni={"fab-config.example.com":{favicon:"",enable:!0}};var Pn=U(K());var j=U(K());function He(t){return j.default.storage.local.get(t)}async function _e(t){return j.default.storage.local.set(t)}async function Mi(t){return new Promise(e=>{He({[t]:""}).then(r=>{if(r[t]){e(r[t]);return}function n(o){o[t]?.newValue&&(e(o[t]?.newValue),j.default.storage.local.onChanged.removeListener(n))}j.default.storage.local.onChanged.addListener(n)})})}async function dt(t){return j.default.storage.local.remove(t)}async function br(t){if(j.default?.cookies){let e=await j.default.cookies.get(t);return e?.value?decodeURIComponent(e.value):null}return j.default.runtime.sendMessage({type:"GET_COOKIE",data:t})}async function xr(t){return j.default?.cookies?await j.default.cookies.set(t):j.default.runtime.sendMessage({type:"SET_COOKIE",data:t})}async function Di(t){return j.default?.tabs?j.default.tabs.create(t):j.default.runtime.sendMessage({type:"OPEN_URL_IN_NEW_TAB",details:t})}async function Fi(t,e){let r=await j.default.tabs.query(t);for(let n of r)n.id&&await j.default.tabs.update(n.id,e)}async function Ui(t,e){let{url:r,...n}=t,o=new URL(r),a=`${o.origin}${o.pathname}/*`,i=await j.default.tabs.query({url:a,...n});if(i.length)for(let s of i)s.id&&(await j.default.tabs.update(s.id,{active:!0}),await j.default.tabs.reload(s.id,e));else{let{url:s,cookieStoreId:u,...c}=t,f={url:Array.isArray(s)?s[0]:s,...c};await j.default.tabs.create(f)}}function $i(t,e){let r="/options.html";t&&(r+=`?section=${t}`),e&&(e.startsWith("#")||(e="#"+e),r+=e),j.default.tabs.create({url:r})}var wr,Hm=new Uint8Array(16);function wn(){if(!wr&&(wr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!wr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return wr(Hm)}var $=[];for(let t=0;t<256;++t)$.push((t+256).toString(16).slice(1));function Bi(t,e=0){return($[t[e+0]]+$[t[e+1]]+$[t[e+2]]+$[t[e+3]]+"-"+$[t[e+4]]+$[t[e+5]]+"-"+$[t[e+6]]+$[t[e+7]]+"-"+$[t[e+8]]+$[t[e+9]]+"-"+$[t[e+10]]+$[t[e+11]]+$[t[e+12]]+$[t[e+13]]+$[t[e+14]]+$[t[e+15]]).toLowerCase()}var Jm=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),_n={randomUUID:Jm};function Qm(t,e,r){if(_n.randomUUID&&!e&&!t)return _n.randomUUID();t=t||{};let n=t.random||(t.rng||wn)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let o=0;o<16;++o)e[r+o]=n[o];return e}return Bi(n)}var X=Qm;var qi=U(K());async function _r(){let{generatedRandomId:t}=await He({generatedRandomId:""});if(!t){let e=await Ym();return e||(e=X(),Zm(e)),qi.default.storage.local.set({generatedRandomId:e}),e}return t}var Gi=q.origin.replace(/\/\/\w+?\./,"//Y2hhdGdwdC1zaWRlYmFy."),Wi="zgv2awnlswq";async function Ym(){try{return await br({url:Gi,name:Wi})}catch{return""}}async function Zm(t){let e=Math.round(Date.now()/1e3)+31104e3;try{return await xr({url:Gi,name:Wi,value:t,expirationDate:e,secure:!0})}catch{}}var Le=(...t)=>t.join("/").replace(/([^:])\/{2,}/g,"$1/");function Vi(t=1e3){return new Promise(e=>{setTimeout(()=>{e()},t)})}async function Je(t,e=1e3,r=2){let n=0;for(;;){try{return await t()}catch(o){if(r>=0&&n++>=r)throw o}await Vi(e)}}function An(t,e=0){let r=!1,n;return(...o)=>(r||(r=!0,n=new Promise((a,i)=>{t(...o).then(s=>{a(s)}).catch(s=>{i(s)}).finally(async()=>{e&&await Vi(e),r=!1})})),n)}async function Ar(){let t=await Sn("userinfo-type");return!!(t&&t!=="device")}async function Xm(){let{vipInfo:t}=await He({vipInfo:{isVIP:!1,remain:0,total:0}});return t}async function Sr(t){let e=await Xm();return _e({vipInfo:{...e,...t}})}async function Qe(){let t=await Tn();return t?{...t,anonymous:!1}:(t=await eg(),{...t,anonymous:!0})}async function Tn(){if(await Ar()){let t=await Sn("token"),e=await Sn("refresh_token");return t?{token:t,refreshToken:e}:null}return null}async function Hi(t){zi("token",t.token),zi("refresh_token",t.refreshToken)}async function eg(){let t=await Ki();if(t)return t;let{__getSiderAnonymousToken__:e}=await He({__getSiderAnonymousToken__:!1});if(e)await Mi("siderApiToken"),t=await Ki();else{_e({__getSiderAnonymousToken__:!0});try{let r=await B.getSiderAnonymousToken();t={token:r.token.token,refreshToken:r.token.refresh_token}}catch(r){throw dt("__getSiderAnonymousToken__"),r}dt("__getSiderAnonymousToken__"),On(t)}return t}async function On(t){return Pn.default.storage.local.set({siderApiToken:t.token,siderApiRefreshToken:t.refreshToken})}async function Ki(){let{siderApiToken:t,siderApiRefreshToken:e}=await Pn.default.storage.local.get(["siderApiToken","siderApiRefreshToken"]);return t?{token:t,refreshToken:e}:null}async function Sn(t){try{return await br({name:t,url:q.origin})}catch{return(await He({[t]:""}))[t]}}function zi(t,e){let r=Math.round(Date.now()/1e3)+7776e3;try{return xr({name:t,value:e,url:q.origin,expirationDate:r,secure:!0})}catch{}}async function Ji(t){let e=Le(q.origin,t),r={token:"",refreshToken:""};try{r=await Qe()}catch{}return`${e}?userinfo=${encodeURIComponent(JSON.stringify({token:r.token,refreshToken:r.refreshToken,clientId:await _r()}))}`}var ee=`ChitChat_${Li?"Edge":"Chrome"}_Ext`,$t=ze,kn=Intl.DateTimeFormat().resolvedOptions().timeZone,B={async refreshToken(t){let e=await re("/v1/user/token/refresh",{refresh_token:t},{headers:{Authorization:""}});return{token:e.token.token,refreshToken:e.token.refresh_token}},getSiderAnonymousToken:An(async()=>{let t=await _r();return re("/v1/user/login/device_id",{device_id:t,uuid:t,app_name:ee,app_version:$t},{headers:{Authorization:""}})}),getVipInfo:An(async()=>{let t;try{if(t=await mt(`/v1/completion/limit?app_name=${ee}&tz_name=${kn}`),!t.chat.count)throw _e({ERR_MUST_LOGIN:!0}),new Error("wrong_data");dt("ERR_VIP_LIMIT")}catch(n){throw n.message!=="wrong_data"&&_e({ERR_VIP_LIMIT:!0}),n}let e=t.chat_period_info[t.user_type],r={isVIP:t.user_type==="premium",total:t.chat.count,remain:t.chat.remain,maxToken:e?.prompt_max_token,award:{device:{count:t.chat_period_info.device.count},login:{count:t.chat_period_info.login.count},premium:{count:t.chat_period_info.premium.count}}};return Sr(r),r},5e3),async getUserSettings(){return(await mt(`/v1/user/settings?app_name=${ee}`)).client_setting},setUserSettings(t){return Je(()=>re("/v1/user/settings",{app_name:ee,client_setting:t}))},getUserPromptList(t){return mt(`/v1/prompt/list?type=${t}&page_size=999`)},createUserPrompt(t){return Je(()=>re("/v1/prompt/create",{is_template:!1,...t}))},editUserPrompt(t){return Je(()=>re("/v1/prompt/edit",t))},delUserPrompt(t){return Je(()=>re("/v1/prompt/update",{id:t,status:"Deleted"}))},async uploadHistoryMsg(t){return(await re("/v1/conversation/upload",{app_name:ee,app_version:$t,messages:t})).cid},uploadConversion(t){return re("/v1/conversation/upload",{share:!0,app_name:ee,app_version:$t,messages:t})},saveConversion(t){return re("/v1/conversation/upload",{save_by_user:!0,app_name:ee,app_version:$t,messages:t})},async shareConversion(t){return(await mt(`/v1/conversation/share/${t}`)).share_key},saveSiderConversion(t){return mt(`/v1/conversation/save-by-user/${t}`)},unSaveSiderConversion(t){return mt(`/v1/conversation/unsave-by-user/${t}`)},delConversion(t){return tg(`/v1/conversation/delete/${t}`)},async sendFeedback({title:t,detail:e,email:r}){let n=await Tn();return re("/v1/app/feedback",{title:t,email:r,data:{detail:e},app_name:ee,app_version:$t},{headers:{Authorization:n?.token||""}})}};async function Cn(t,e=null,r={}){t.startsWith("http")||(t=Le(q.api,t)),r.headers||(r.headers={});let n="";"Authorization"in r.headers||(n=(await Qe()).token);let o={"Content-Type":"application/json",Authorization:n};if(r.headers={...o,...r.headers},e)try{r.body=JSON.stringify(e)}catch{r.body=e}let a=await fetch(t,r),i=await a.json();return dt("ERR_MUST_LOGIN"),!a.ok||i.code!==0?((i.code===1003||i.code===1006)&&_e({ERR_MUST_LOGIN:!0}),Promise.reject(i)):i.data}function mt(t,e=null,r={}){return Cn(t,e,{method:"GET",...r})}function re(t,e=null,r={}){return Cn(t,e,{method:"POST",...r})}function tg(t,e=null,r={}){return Cn(t,e,{method:"DELETE",...r})}var Ne=U(K());async function Qi(){return(await Ne.default.cookies.getAll({domain:".chat.openai.com"})).some(r=>r.name=="__Secure-next-auth.session-token")}async function En(t){if(Ne.default?.scripting?.executeScript)return Ne.default.scripting.executeScript(t)}function Rn(t,e,r){let n=Ne.default.runtime.getURL("chat/index.html");Ne.default.tabs.query({url:n+"*",currentWindow:!0}).then(async o=>{o.length?(await Ne.default.tabs.update(o[0].id,{active:!0}),e&&e()):(r&&await r(),await Ne.default.tabs.create({url:n+(t?"?reason="+t:"")}))})}async function Yi(){Di({url:await Ji("/login")})}function G(t){return G=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(t)}function ne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function In(t,e){if(G(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(G(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bt(t){var e=In(t,"string");return G(e)==="symbol"?e:String(e)}function Zi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bt(n.key),n)}}function oe(t,e,r){return e&&Zi(t.prototype,e),r&&Zi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ue(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qt(t,e){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},qt(t,e)}function gt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qt(t,e)}function Ye(t,e){if(e&&(G(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ue(t)}function ae(t){return ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ae(t)}function pe(t,e,r){return e=Bt(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jn(t){if(Array.isArray(t))return t}function Ln(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Pr(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Nn(t,e){if(t){if(typeof t=="string")return Pr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pr(t,e)}}function Mn(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dn(t){return jn(t)||Ln(t)||Nn(t)||Mn()}function Xi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function es(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Xi(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xi(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var rg={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,r){console&&console[e]}},ng=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ne(this,t),this.init(e,r)}return oe(t,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=r||rg,this.options=n,this.debug=n.debug}},{key:"setDebug",value:function(r){this.debug=r}},{key:"log",value:function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return this.forward(n,"log","",!0)}},{key:"warn",value:function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return this.forward(n,"warn","",!0)}},{key:"error",value:function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return this.forward(n,"error","")}},{key:"deprecate",value:function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(r,n,o,a){return a&&!this.debug?null:(typeof r[0]=="string"&&(r[0]="".concat(o).concat(this.prefix," ").concat(r[0])),this.logger[n](r))}},{key:"create",value:function(r){return new t(this.logger,es(es({},{prefix:"".concat(this.prefix,":").concat(r,":")}),this.options))}},{key:"clone",value:function(r){return r=r||this.options,r.prefix=r.prefix||this.prefix,new t(this.logger,r)}}]),t}(),me=new ng,Me=function(){function t(){ne(this,t),this.observers={}}return oe(t,[{key:"on",value:function(r,n){var o=this;return r.split(" ").forEach(function(a){o.observers[a]=o.observers[a]||[],o.observers[a].push(n)}),this}},{key:"off",value:function(r,n){if(this.observers[r]){if(!n){delete this.observers[r];return}this.observers[r]=this.observers[r].filter(function(o){return o!==n})}}},{key:"emit",value:function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];if(this.observers[r]){var i=[].concat(this.observers[r]);i.forEach(function(u){u.apply(void 0,o)})}if(this.observers["*"]){var s=[].concat(this.observers["*"]);s.forEach(function(u){u.apply(u,[r].concat(o))})}}}]),t}();function Gt(){var t,e,r=new Promise(function(n,o){t=n,e=o});return r.resolve=t,r.reject=e,r}function ts(t){return t==null?"":""+t}function og(t,e,r){t.forEach(function(n){e[n]&&(r[n]=e[n])})}function Un(t,e,r){function n(s){return s&&s.indexOf("###")>-1?s.replace(/###/g,"."):s}function o(){return!t||typeof t=="string"}for(var a=typeof e!="string"?[].concat(e):e.split(".");a.length>1;){if(o())return{};var i=n(a.shift());!t[i]&&r&&(t[i]=new r),Object.prototype.hasOwnProperty.call(t,i)?t=t[i]:t={}}return o()?{}:{obj:t,k:n(a.shift())}}function rs(t,e,r){var n=Un(t,e,Object),o=n.obj,a=n.k;o[a]=r}function ag(t,e,r,n){var o=Un(t,e,Object),a=o.obj,i=o.k;a[i]=a[i]||[],n&&(a[i]=a[i].concat(r)),n||a[i].push(r)}function kr(t,e){var r=Un(t,e),n=r.obj,o=r.k;if(n)return n[o]}function ns(t,e,r){var n=kr(t,r);return n!==void 0?n:kr(e,r)}function ys(t,e,r){for(var n in e)n!=="__proto__"&&n!=="constructor"&&(n in t?typeof t[n]=="string"||t[n]instanceof String||typeof e[n]=="string"||e[n]instanceof String?r&&(t[n]=e[n]):ys(t[n],e[n],r):t[n]=e[n]);return t}function ht(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var ig={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function sg(t){return typeof t=="string"?t.replace(/[&<>"'\/]/g,function(e){return ig[e]}):t}var Er=typeof window<"u"&&window.navigator&&typeof window.navigator.userAgentData>"u"&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,ug=[" ",",","?","!",";"];function cg(t,e,r){e=e||"",r=r||"";var n=ug.filter(function(s){return e.indexOf(s)<0&&r.indexOf(s)<0});if(n.length===0)return!0;var o=new RegExp("(".concat(n.map(function(s){return s==="?"?"\\?":s}).join("|"),")")),a=!o.test(t);if(!a){var i=t.indexOf(r);i>0&&!o.test(t.substring(0,i))&&(a=!0)}return a}function os(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Tr(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?os(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):os(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function lg(t){var e=fg();return function(){var n=ae(t),o;if(e){var a=ae(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return Ye(this,o)}}function fg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vs(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(t){if(t[e])return t[e];for(var n=e.split(r),o=t,a=0;a<n.length;++a){if(!o||typeof o[n[a]]=="string"&&a+1<n.length)return;if(o[n[a]]===void 0){for(var i=2,s=n.slice(a,a+i).join(r),u=o[s];u===void 0&&n.length>a+i;)i++,s=n.slice(a,a+i).join(r),u=o[s];if(u===void 0)return;if(u===null)return null;if(e.endsWith(s)){if(typeof u=="string")return u;if(s&&typeof u[s]=="string")return u[s]}var c=n.slice(a+i).join(r);return c?vs(u,c,r):void 0}o=o[n[a]]}return o}}var pg=function(t){gt(r,t);var e=lg(r);function r(n){var o,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};return ne(this,r),o=e.call(this),Er&&Me.call(ue(o)),o.data=n||{},o.options=a,o.options.keySeparator===void 0&&(o.options.keySeparator="."),o.options.ignoreJSONStructure===void 0&&(o.options.ignoreJSONStructure=!0),o}return oe(r,[{key:"addNamespaces",value:function(o){this.options.ns.indexOf(o)<0&&this.options.ns.push(o)}},{key:"removeNamespaces",value:function(o){var a=this.options.ns.indexOf(o);a>-1&&this.options.ns.splice(a,1)}},{key:"getResource",value:function(o,a,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},u=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,c=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure,f=[o,a];i&&typeof i!="string"&&(f=f.concat(i)),i&&typeof i=="string"&&(f=f.concat(u?i.split(u):i)),o.indexOf(".")>-1&&(f=o.split("."));var l=kr(this.data,f);return l||!c||typeof i!="string"?l:vs(this.data&&this.data[o]&&this.data[o][a],i,u)}},{key:"addResource",value:function(o,a,i,s){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},c=this.options.keySeparator;c===void 0&&(c=".");var f=[o,a];i&&(f=f.concat(c?i.split(c):i)),o.indexOf(".")>-1&&(f=o.split("."),s=a,a=f[1]),this.addNamespaces(a),rs(this.data,f,s),u.silent||this.emit("added",o,a,i,s)}},{key:"addResources",value:function(o,a,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(var u in i)(typeof i[u]=="string"||Object.prototype.toString.apply(i[u])==="[object Array]")&&this.addResource(o,a,u,i[u],{silent:!0});s.silent||this.emit("added",o,a,i)}},{key:"addResourceBundle",value:function(o,a,i,s,u){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},f=[o,a];o.indexOf(".")>-1&&(f=o.split("."),s=i,i=a,a=f[1]),this.addNamespaces(a);var l=kr(this.data,f)||{};s?ys(l,i,u):l=Tr(Tr({},l),i),rs(this.data,f,l),c.silent||this.emit("added",o,a,i)}},{key:"removeResourceBundle",value:function(o,a){this.hasResourceBundle(o,a)&&delete this.data[o][a],this.removeNamespaces(a),this.emit("removed",o,a)}},{key:"hasResourceBundle",value:function(o,a){return this.getResource(o,a)!==void 0}},{key:"getResourceBundle",value:function(o,a){return a||(a=this.options.defaultNS),this.options.compatibilityAPI==="v1"?Tr(Tr({},{}),this.getResource(o,a)):this.getResource(o,a)}},{key:"getDataByLanguage",value:function(o){return this.data[o]}},{key:"hasLanguageSomeTranslations",value:function(o){var a=this.getDataByLanguage(o),i=a&&Object.keys(a)||[];return!!i.find(function(s){return a[s]&&Object.keys(a[s]).length>0})}},{key:"toJSON",value:function(){return this.data}}]),r}(Me),bs={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,r,n,o,a){var i=this;return e.forEach(function(s){i.processors[s]&&(r=i.processors[s].process(r,n,o,a))}),r}};function as(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function H(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?as(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):as(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dg(t){var e=mg();return function(){var n=ae(t),o;if(e){var a=ae(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return Ye(this,o)}}function mg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var is={},ss=function(t){gt(r,t);var e=dg(r);function r(n){var o,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ne(this,r),o=e.call(this),Er&&Me.call(ue(o)),og(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],n,ue(o)),o.options=a,o.options.keySeparator===void 0&&(o.options.keySeparator="."),o.logger=me.create("translator"),o}return oe(r,[{key:"changeLanguage",value:function(o){o&&(this.language=o)}},{key:"exists",value:function(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(o==null)return!1;var i=this.resolve(o,a);return i&&i.res!==void 0}},{key:"extractFromKey",value:function(o,a){var i=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");var s=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,u=a.ns||this.options.defaultNS||[],c=i&&o.indexOf(i)>-1,f=!this.options.userDefinedKeySeparator&&!a.keySeparator&&!this.options.userDefinedNsSeparator&&!a.nsSeparator&&!cg(o,i,s);if(c&&!f){var l=o.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:o,namespaces:u};var p=o.split(i);(i!==s||i===s&&this.options.ns.indexOf(p[0])>-1)&&(u=p.shift()),o=p.join(s)}return typeof u=="string"&&(u=[u]),{key:o,namespaces:u}}},{key:"translate",value:function(o,a,i){var s=this;if(G(a)!=="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),a||(a={}),o==null)return"";Array.isArray(o)||(o=[String(o)]);var u=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,c=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,f=this.extractFromKey(o[o.length-1],a),l=f.key,p=f.namespaces,d=p[p.length-1],y=a.lng||this.language,w=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(y&&y.toLowerCase()==="cimode"){if(w){var b=a.nsSeparator||this.options.nsSeparator;return u?{res:"".concat(d).concat(b).concat(l),usedKey:l,exactUsedKey:l,usedLng:y,usedNS:d}:"".concat(d).concat(b).concat(l)}return u?{res:l,usedKey:l,exactUsedKey:l,usedLng:y,usedNS:d}:l}var m=this.resolve(o,a),h=m&&m.res,O=m&&m.usedKey||l,g=m&&m.exactUsedKey||l,v=Object.prototype.toString.apply(h),x=["[object Number]","[object Function]","[object RegExp]"],S=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,C=!this.i18nFormat||this.i18nFormat.handleAsObject,R=typeof h!="string"&&typeof h!="boolean"&&typeof h!="number";if(C&&h&&R&&x.indexOf(v)<0&&!(typeof S=="string"&&v==="[object Array]")){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var M=this.options.returnedObjectHandler?this.options.returnedObjectHandler(O,h,H(H({},a),{},{ns:p})):"key '".concat(l," (").concat(this.language,")' returned an object instead of string.");return u?(m.res=M,m):M}if(c){var T=v==="[object Array]",F=T?[]:{},N=T?g:O;for(var Z in h)if(Object.prototype.hasOwnProperty.call(h,Z)){var Se="".concat(N).concat(c).concat(Z);F[Z]=this.translate(Se,H(H({},a),{joinArrays:!1,ns:p})),F[Z]===Se&&(F[Z]=h[Z])}h=F}}else if(C&&typeof S=="string"&&v==="[object Array]")h=h.join(S),h&&(h=this.extendTranslation(h,o,a,i));else{var J=!1,ve=!1,Ko=a.count!==void 0&&typeof a.count!="string",un=r.hasDefaultValue(a),Fl=Ko?this.pluralResolver.getSuffix(y,a.count,a):"",Ot=a["defaultValue".concat(Fl)]||a.defaultValue;!this.isValidLookup(h)&&un&&(J=!0,h=Ot),this.isValidLookup(h)||(ve=!0,h=l);var Ul=a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey,$l=Ul&&ve?void 0:h,kt=un&&Ot!==h&&this.options.updateMissing;if(ve||J||kt){if(this.logger.log(kt?"updateKey":"missingKey",y,d,l,kt?Ot:h),c){var zo=this.resolve(l,H(H({},a),{},{keySeparator:!1}));zo&&zo.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var Ct=[],rr=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&rr&&rr[0])for(var cn=0;cn<rr.length;cn++)Ct.push(rr[cn]);else this.options.saveMissingTo==="all"?Ct=this.languageUtils.toResolveHierarchy(a.lng||this.language):Ct.push(a.lng||this.language);var Ho=function(tt,fn,_){var Jo=un&&_!==h?_:$l;s.options.missingKeyHandler?s.options.missingKeyHandler(tt,d,fn,Jo,kt,a):s.backendConnector&&s.backendConnector.saveMissing&&s.backendConnector.saveMissing(tt,d,fn,Jo,kt,a),s.emit("missingKey",tt,d,fn,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&Ko?Ct.forEach(function(ln){s.pluralResolver.getSuffixes(ln,a).forEach(function(tt){Ho([ln],l+tt,a["defaultValue".concat(tt)]||Ot)})}):Ho(Ct,l,Ot))}h=this.extendTranslation(h,o,a,m,i),ve&&h===l&&this.options.appendNamespaceToMissingKey&&(h="".concat(d,":").concat(l)),(ve||J)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(d,":").concat(l):l,J?h:void 0):h=this.options.parseMissingKeyHandler(h))}return u?(m.res=h,m):h}},{key:"extendTranslation",value:function(o,a,i,s,u){var c=this;if(this.i18nFormat&&this.i18nFormat.parse)o=this.i18nFormat.parse(o,H(H({},this.options.interpolation.defaultVariables),i),s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init(H(H({},i),{interpolation:H(H({},this.options.interpolation),i.interpolation)}));var f=typeof o=="string"&&(i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),l;if(f){var p=o.match(this.interpolator.nestingRegexp);l=p&&p.length}var d=i.replace&&typeof i.replace!="string"?i.replace:i;if(this.options.interpolation.defaultVariables&&(d=H(H({},this.options.interpolation.defaultVariables),d)),o=this.interpolator.interpolate(o,d,i.lng||this.language,i),f){var y=o.match(this.interpolator.nestingRegexp),w=y&&y.length;l<w&&(i.nest=!1)}i.nest!==!1&&(o=this.interpolator.nest(o,function(){for(var h=arguments.length,O=new Array(h),g=0;g<h;g++)O[g]=arguments[g];return u&&u[0]===O[0]&&!i.context?(c.logger.warn("It seems you are nesting recursively key: ".concat(O[0]," in key: ").concat(a[0])),null):c.translate.apply(c,O.concat([a]))},i)),i.interpolation&&this.interpolator.reset()}var b=i.postProcess||this.options.postProcess,m=typeof b=="string"?[b]:b;return o!=null&&m&&m.length&&i.applyPostProcessor!==!1&&(o=bs.handle(m,o,a,this.options&&this.options.postProcessPassResolved?H({i18nResolved:s},i):i,this)),o}},{key:"resolve",value:function(o){var a=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s,u,c,f,l;return typeof o=="string"&&(o=[o]),o.forEach(function(p){if(!a.isValidLookup(s)){var d=a.extractFromKey(p,i),y=d.key;u=y;var w=d.namespaces;a.options.fallbackNS&&(w=w.concat(a.options.fallbackNS));var b=i.count!==void 0&&typeof i.count!="string",m=b&&!i.ordinal&&i.count===0&&a.pluralResolver.shouldUseIntlApi(),h=i.context!==void 0&&(typeof i.context=="string"||typeof i.context=="number")&&i.context!=="",O=i.lngs?i.lngs:a.languageUtils.toResolveHierarchy(i.lng||a.language,i.fallbackLng);w.forEach(function(g){a.isValidLookup(s)||(l=g,!is["".concat(O[0],"-").concat(g)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(l)&&(is["".concat(O[0],"-").concat(g)]=!0,a.logger.warn('key "'.concat(u,'" for languages "').concat(O.join(", "),`" won't get resolved as namespace "`).concat(l,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),O.forEach(function(v){if(!a.isValidLookup(s)){f=v;var x=[y];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(x,y,v,g,i);else{var S;b&&(S=a.pluralResolver.getSuffix(v,i.count,i));var C="".concat(a.options.pluralSeparator,"zero");if(b&&(x.push(y+S),m&&x.push(y+C)),h){var R="".concat(y).concat(a.options.contextSeparator).concat(i.context);x.push(R),b&&(x.push(R+S),m&&x.push(R+C))}}for(var M;M=x.pop();)a.isValidLookup(s)||(c=M,s=a.getResource(v,g,M,i))}}))})}}),{res:s,usedKey:u,exactUsedKey:c,usedLng:f,usedNS:l}}},{key:"isValidLookup",value:function(o){return o!==void 0&&!(!this.options.returnNull&&o===null)&&!(!this.options.returnEmptyString&&o==="")}},{key:"getResource",value:function(o,a,i){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(o,a,i,s):this.resourceStore.getResource(o,a,i,s)}}],[{key:"hasDefaultValue",value:function(o){var a="defaultValue";for(var i in o)if(Object.prototype.hasOwnProperty.call(o,i)&&a===i.substring(0,a.length)&&o[i]!==void 0)return!0;return!1}}]),r}(Me);function Fn(t){return t.charAt(0).toUpperCase()+t.slice(1)}var us=function(){function t(e){ne(this,t),this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=me.create("languageUtils")}return oe(t,[{key:"getScriptPartFromCode",value:function(r){if(!r||r.indexOf("-")<0)return null;var n=r.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}},{key:"getLanguagePartFromCode",value:function(r){if(!r||r.indexOf("-")<0)return r;var n=r.split("-");return this.formatLanguageCode(n[0])}},{key:"formatLanguageCode",value:function(r){if(typeof r=="string"&&r.indexOf("-")>-1){var n=["hans","hant","latn","cyrl","cans","mong","arab"],o=r.split("-");return this.options.lowerCaseLng?o=o.map(function(a){return a.toLowerCase()}):o.length===2?(o[0]=o[0].toLowerCase(),o[1]=o[1].toUpperCase(),n.indexOf(o[1].toLowerCase())>-1&&(o[1]=Fn(o[1].toLowerCase()))):o.length===3&&(o[0]=o[0].toLowerCase(),o[1].length===2&&(o[1]=o[1].toUpperCase()),o[0]!=="sgn"&&o[2].length===2&&(o[2]=o[2].toUpperCase()),n.indexOf(o[1].toLowerCase())>-1&&(o[1]=Fn(o[1].toLowerCase())),n.indexOf(o[2].toLowerCase())>-1&&(o[2]=Fn(o[2].toLowerCase()))),o.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?r.toLowerCase():r}},{key:"isSupportedCode",value:function(r){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(r=this.getLanguagePartFromCode(r)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(r)>-1}},{key:"getBestMatchFromCodes",value:function(r){var n=this;if(!r)return null;var o;return r.forEach(function(a){if(!o){var i=n.formatLanguageCode(a);(!n.options.supportedLngs||n.isSupportedCode(i))&&(o=i)}}),!o&&this.options.supportedLngs&&r.forEach(function(a){if(!o){var i=n.getLanguagePartFromCode(a);if(n.isSupportedCode(i))return o=i;o=n.options.supportedLngs.find(function(s){if(s.indexOf(i)===0)return s})}}),o||(o=this.getFallbackCodes(this.options.fallbackLng)[0]),o}},{key:"getFallbackCodes",value:function(r,n){if(!r)return[];if(typeof r=="function"&&(r=r(n)),typeof r=="string"&&(r=[r]),Object.prototype.toString.apply(r)==="[object Array]")return r;if(!n)return r.default||[];var o=r[n];return o||(o=r[this.getScriptPartFromCode(n)]),o||(o=r[this.formatLanguageCode(n)]),o||(o=r[this.getLanguagePartFromCode(n)]),o||(o=r.default),o||[]}},{key:"toResolveHierarchy",value:function(r,n){var o=this,a=this.getFallbackCodes(n||this.options.fallbackLng||[],r),i=[],s=function(c){c&&(o.isSupportedCode(c)?i.push(c):o.logger.warn("rejecting language code not found in supportedLngs: ".concat(c)))};return typeof r=="string"&&r.indexOf("-")>-1?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(r)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(r)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(r))):typeof r=="string"&&s(this.formatLanguageCode(r)),a.forEach(function(u){i.indexOf(u)<0&&s(o.formatLanguageCode(u))}),i}}]),t}(),gg=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],hg={1:function(e){return+(e>1)},2:function(e){return+(e!=1)},3:function(e){return 0},4:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},5:function(e){return e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},6:function(e){return e==1?0:e>=2&&e<=4?1:2},7:function(e){return e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},8:function(e){return e==1?0:e==2?1:e!=8&&e!=11?2:3},9:function(e){return+(e>=2)},10:function(e){return e==1?0:e==2?1:e<7?2:e<11?3:4},11:function(e){return e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3},12:function(e){return+(e%10!=1||e%100==11)},13:function(e){return+(e!==0)},14:function(e){return e==1?0:e==2?1:e==3?2:3},15:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2},16:function(e){return e%10==1&&e%100!=11?0:e!==0?1:2},17:function(e){return e==1||e%10==1&&e%100!=11?0:1},18:function(e){return e==0?0:e==1?1:2},19:function(e){return e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3},20:function(e){return e==1?0:e==0||e%100>0&&e%100<20?1:2},21:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0},22:function(e){return e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3}},yg=["v1","v2","v3"],cs={zero:0,one:1,two:2,few:3,many:4,other:5};function vg(){var t={};return gg.forEach(function(e){e.lngs.forEach(function(r){t[r]={numbers:e.nr,plurals:hg[e.fc]}})}),t}var bg=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ne(this,t),this.languageUtils=e,this.options=r,this.logger=me.create("pluralResolver"),(!this.options.compatibilityJSON||this.options.compatibilityJSON==="v4")&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=vg()}return oe(t,[{key:"addRule",value:function(r,n){this.rules[r]=n}},{key:"getRule",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(r,{type:n.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[r]||this.rules[this.languageUtils.getLanguagePartFromCode(r)]}},{key:"needsPlural",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.getRule(r,n);return this.shouldUseIntlApi()?o&&o.resolvedOptions().pluralCategories.length>1:o&&o.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(r,o).map(function(a){return"".concat(n).concat(a)})}},{key:"getSuffixes",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.getRule(r,o);return a?this.shouldUseIntlApi()?a.resolvedOptions().pluralCategories.sort(function(i,s){return cs[i]-cs[s]}).map(function(i){return"".concat(n.options.prepend).concat(i)}):a.numbers.map(function(i){return n.getSuffix(r,i,o)}):[]}},{key:"getSuffix",value:function(r,n){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=this.getRule(r,o);return a?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(a.select(n)):this.getSuffixRetroCompatible(a,n):(this.logger.warn("no plural rule found for: ".concat(r)),"")}},{key:"getSuffixRetroCompatible",value:function(r,n){var o=this,a=r.noAbs?r.plurals(n):r.plurals(Math.abs(n)),i=r.numbers[a];this.options.simplifyPluralSuffix&&r.numbers.length===2&&r.numbers[0]===1&&(i===2?i="plural":i===1&&(i=""));var s=function(){return o.options.prepend&&i.toString()?o.options.prepend+i.toString():i.toString()};return this.options.compatibilityJSON==="v1"?i===1?"":typeof i=="number"?"_plural_".concat(i.toString()):s():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&r.numbers.length===2&&r.numbers[0]===1?s():this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString()}},{key:"shouldUseIntlApi",value:function(){return!yg.includes(this.options.compatibilityJSON)}}]),t}();function ls(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ce(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ls(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ls(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var xg=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ne(this,t),this.logger=me.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(r){return r},this.init(e)}return oe(t,[{key:"init",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};r.interpolation||(r.interpolation={escapeValue:!0});var n=r.interpolation;this.escape=n.escape!==void 0?n.escape:sg,this.escapeValue=n.escapeValue!==void 0?n.escapeValue:!0,this.useRawValueToEscape=n.useRawValueToEscape!==void 0?n.useRawValueToEscape:!1,this.prefix=n.prefix?ht(n.prefix):n.prefixEscaped||"{{",this.suffix=n.suffix?ht(n.suffix):n.suffixEscaped||"}}",this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||",",this.unescapePrefix=n.unescapeSuffix?"":n.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":n.unescapeSuffix||"",this.nestingPrefix=n.nestingPrefix?ht(n.nestingPrefix):n.nestingPrefixEscaped||ht("$t("),this.nestingSuffix=n.nestingSuffix?ht(n.nestingSuffix):n.nestingSuffixEscaped||ht(")"),this.nestingOptionsSeparator=n.nestingOptionsSeparator?n.nestingOptionsSeparator:n.nestingOptionsSeparator||",",this.maxReplaces=n.maxReplaces?n.maxReplaces:1e3,this.alwaysFormat=n.alwaysFormat!==void 0?n.alwaysFormat:!1,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var r="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(r,"g");var n="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(n,"g");var o="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(o,"g")}},{key:"interpolate",value:function(r,n,o,a){var i=this,s,u,c,f=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function l(b){return b.replace(/\$/g,"$$$$")}var p=function(m){if(m.indexOf(i.formatSeparator)<0){var h=ns(n,f,m);return i.alwaysFormat?i.format(h,void 0,o,ce(ce(ce({},a),n),{},{interpolationkey:m})):h}var O=m.split(i.formatSeparator),g=O.shift().trim(),v=O.join(i.formatSeparator).trim();return i.format(ns(n,f,g),v,o,ce(ce(ce({},a),n),{},{interpolationkey:g}))};this.resetRegExp();var d=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,y=a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables,w=[{regex:this.regexpUnescape,safeValue:function(m){return l(m)}},{regex:this.regexp,safeValue:function(m){return i.escapeValue?l(i.escape(m)):l(m)}}];return w.forEach(function(b){for(c=0;s=b.regex.exec(r);){var m=s[1].trim();if(u=p(m),u===void 0)if(typeof d=="function"){var h=d(r,s,a);u=typeof h=="string"?h:""}else if(a&&Object.prototype.hasOwnProperty.call(a,m))u="";else if(y){u=s[0];continue}else i.logger.warn("missed to pass in variable ".concat(m," for interpolating ").concat(r)),u="";else typeof u!="string"&&!i.useRawValueToEscape&&(u=ts(u));var O=b.safeValue(u);if(r=r.replace(s[0],O),y?(b.regex.lastIndex+=u.length,b.regex.lastIndex-=s[0].length):b.regex.lastIndex=0,c++,c>=i.maxReplaces)break}}),r}},{key:"nest",value:function(r,n){var o=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,s,u;function c(d,y){var w=this.nestingOptionsSeparator;if(d.indexOf(w)<0)return d;var b=d.split(new RegExp("".concat(w,"[ ]*{"))),m="{".concat(b[1]);d=b[0],m=this.interpolate(m,u);var h=m.match(/'/g),O=m.match(/"/g);(h&&h.length%2===0&&!O||O.length%2!==0)&&(m=m.replace(/'/g,'"'));try{u=JSON.parse(m),y&&(u=ce(ce({},y),u))}catch(g){return this.logger.warn("failed parsing options string in nesting for key ".concat(d),g),"".concat(d).concat(w).concat(m)}return delete u.defaultValue,d}for(;i=this.nestingRegexp.exec(r);){var f=[];u=ce({},a),u=u.replace&&typeof u.replace!="string"?u.replace:u,u.applyPostProcessor=!1,delete u.defaultValue;var l=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){var p=i[1].split(this.formatSeparator).map(function(d){return d.trim()});i[1]=p.shift(),f=p,l=!0}if(s=n(c.call(this,i[1].trim(),u),u),s&&i[0]===r&&typeof s!="string")return s;typeof s!="string"&&(s=ts(s)),s||(this.logger.warn("missed to resolve ".concat(i[1]," for nesting ").concat(r)),s=""),l&&(s=f.reduce(function(d,y){return o.format(d,y,a.lng,ce(ce({},a),{},{interpolationkey:i[1].trim()}))},s.trim())),r=r.replace(i[0],s),this.regexp.lastIndex=0}return r}}]),t}();function fs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Ae(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?fs(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wg(t){var e=t.toLowerCase().trim(),r={};if(t.indexOf("(")>-1){var n=t.split("(");e=n[0].toLowerCase().trim();var o=n[1].substring(0,n[1].length-1);if(e==="currency"&&o.indexOf(":")<0)r.currency||(r.currency=o.trim());else if(e==="relativetime"&&o.indexOf(":")<0)r.range||(r.range=o.trim());else{var a=o.split(";");a.forEach(function(i){if(i){var s=i.split(":"),u=Dn(s),c=u[0],f=u.slice(1),l=f.join(":").trim().replace(/^'+|'+$/g,"");r[c.trim()]||(r[c.trim()]=l),l==="false"&&(r[c.trim()]=!1),l==="true"&&(r[c.trim()]=!0),isNaN(l)||(r[c.trim()]=parseInt(l,10))}})}}return{formatName:e,formatOptions:r}}function yt(t){var e={};return function(n,o,a){var i=o+JSON.stringify(a),s=e[i];return s||(s=t(o,a),e[i]=s),s(n)}}var _g=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ne(this,t),this.logger=me.create("formatter"),this.options=e,this.formats={number:yt(function(r,n){var o=new Intl.NumberFormat(r,Ae({},n));return function(a){return o.format(a)}}),currency:yt(function(r,n){var o=new Intl.NumberFormat(r,Ae(Ae({},n),{},{style:"currency"}));return function(a){return o.format(a)}}),datetime:yt(function(r,n){var o=new Intl.DateTimeFormat(r,Ae({},n));return function(a){return o.format(a)}}),relativetime:yt(function(r,n){var o=new Intl.RelativeTimeFormat(r,Ae({},n));return function(a){return o.format(a,n.range||"day")}}),list:yt(function(r,n){var o=new Intl.ListFormat(r,Ae({},n));return function(a){return o.format(a)}})},this.init(e)}return oe(t,[{key:"init",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}},o=n.interpolation;this.formatSeparator=o.formatSeparator?o.formatSeparator:o.formatSeparator||","}},{key:"add",value:function(r,n){this.formats[r.toLowerCase().trim()]=n}},{key:"addCached",value:function(r,n){this.formats[r.toLowerCase().trim()]=yt(n)}},{key:"format",value:function(r,n,o){var a=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=n.split(this.formatSeparator),u=s.reduce(function(c,f){var l=wg(f),p=l.formatName,d=l.formatOptions;if(a.formats[p]){var y=c;try{var w=i&&i.formatParams&&i.formatParams[i.interpolationkey]||{},b=w.locale||w.lng||i.locale||i.lng||o;y=a.formats[p](c,b,Ae(Ae(Ae({},d),i),w))}catch(m){a.logger.warn(m)}return y}else a.logger.warn("there was no format function for ".concat(p));return c},r);return u}}]),t}();function ps(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ds(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ps(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ag(t){var e=Sg();return function(){var n=ae(t),o;if(e){var a=ae(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return Ye(this,o)}}function Sg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Pg(t,e){t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)}var Tg=function(t){gt(r,t);var e=Ag(r);function r(n,o,a){var i,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return ne(this,r),i=e.call(this),Er&&Me.call(ue(i)),i.backend=n,i.store=o,i.services=a,i.languageUtils=a.languageUtils,i.options=s,i.logger=me.create("backendConnector"),i.waitingReads=[],i.maxParallelReads=s.maxParallelReads||10,i.readingCalls=0,i.maxRetries=s.maxRetries>=0?s.maxRetries:5,i.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(a,s.backend,s),i}return oe(r,[{key:"queueLoad",value:function(o,a,i,s){var u=this,c={},f={},l={},p={};return o.forEach(function(d){var y=!0;a.forEach(function(w){var b="".concat(d,"|").concat(w);!i.reload&&u.store.hasResourceBundle(d,w)?u.state[b]=2:u.state[b]<0||(u.state[b]===1?f[b]===void 0&&(f[b]=!0):(u.state[b]=1,y=!1,f[b]===void 0&&(f[b]=!0),c[b]===void 0&&(c[b]=!0),p[w]===void 0&&(p[w]=!0)))}),y||(l[d]=!0)}),(Object.keys(c).length||Object.keys(f).length)&&this.queue.push({pending:f,pendingCount:Object.keys(f).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(c),pending:Object.keys(f),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(p)}}},{key:"loaded",value:function(o,a,i){var s=o.split("|"),u=s[0],c=s[1];a&&this.emit("failedLoading",u,c,a),i&&this.store.addResourceBundle(u,c,i),this.state[o]=a?-1:2;var f={};this.queue.forEach(function(l){ag(l.loaded,[u],c),Pg(l,o),a&&l.errors.push(a),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(function(p){f[p]||(f[p]={});var d=l.loaded[p];d.length&&d.forEach(function(y){f[p][y]===void 0&&(f[p][y]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",f),this.queue=this.queue.filter(function(l){return!l.done})}},{key:"read",value:function(o,a,i){var s=this,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,f=arguments.length>5?arguments[5]:void 0;if(!o.length)return f(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:o,ns:a,fcName:i,tried:u,wait:c,callback:f});return}this.readingCalls++;var l=function(w,b){if(s.readingCalls--,s.waitingReads.length>0){var m=s.waitingReads.shift();s.read(m.lng,m.ns,m.fcName,m.tried,m.wait,m.callback)}if(w&&b&&u<s.maxRetries){setTimeout(function(){s.read.call(s,o,a,i,u+1,c*2,f)},c);return}f(w,b)},p=this.backend[i].bind(this.backend);if(p.length===2){try{var d=p(o,a);d&&typeof d.then=="function"?d.then(function(y){return l(null,y)}).catch(l):l(null,d)}catch(y){l(y)}return}return p(o,a,l)}},{key:"prepareLoading",value:function(o,a){var i=this,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),u&&u();typeof o=="string"&&(o=this.languageUtils.toResolveHierarchy(o)),typeof a=="string"&&(a=[a]);var c=this.queueLoad(o,a,s,u);if(!c.toLoad.length)return c.pending.length||u(),null;c.toLoad.forEach(function(f){i.loadOne(f)})}},{key:"load",value:function(o,a,i){this.prepareLoading(o,a,{},i)}},{key:"reload",value:function(o,a,i){this.prepareLoading(o,a,{reload:!0},i)}},{key:"loadOne",value:function(o){var a=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=o.split("|"),u=s[0],c=s[1];this.read(u,c,"read",void 0,void 0,function(f,l){f&&a.logger.warn("".concat(i,"loading namespace ").concat(c," for language ").concat(u," failed"),f),!f&&l&&a.logger.log("".concat(i,"loaded namespace ").concat(c," for language ").concat(u),l),a.loaded(o,f,l)})}},{key:"saveMissing",value:function(o,a,i,s,u){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},f=arguments.length>6&&arguments[6]!==void 0?arguments[6]:function(){};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(a)){this.logger.warn('did not save key "'.concat(i,'" as the namespace "').concat(a,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend&&this.backend.create){var l=ds(ds({},c),{},{isUpdate:u}),p=this.backend.create.bind(this.backend);if(p.length<6)try{var d;p.length===5?d=p(o,a,i,s,l):d=p(o,a,i,s),d&&typeof d.then=="function"?d.then(function(y){return f(null,y)}).catch(f):f(null,d)}catch(y){f(y)}else p(o,a,i,s,f,l)}!o||!o[0]||this.store.addResource(o[0],a,i,s)}}}]),r}(Me);function ms(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var r={};if(G(e[1])==="object"&&(r=e[1]),typeof e[1]=="string"&&(r.defaultValue=e[1]),typeof e[2]=="string"&&(r.tDescription=e[2]),G(e[2])==="object"||G(e[3])==="object"){var n=e[3]||e[2];Object.keys(n).forEach(function(o){r[o]=n[o]})}return r},interpolation:{escapeValue:!0,format:function(e,r,n,o){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function gs(t){return typeof t.ns=="string"&&(t.ns=[t.ns]),typeof t.fallbackLng=="string"&&(t.fallbackLng=[t.fallbackLng]),typeof t.fallbackNS=="string"&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function hs(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function de(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?hs(Object(r),!0).forEach(function(n){pe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hs(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Og(t){var e=kg();return function(){var n=ae(t),o;if(e){var a=ae(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return Ye(this,o)}}function kg(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Or(){}function Cg(t){var e=Object.getOwnPropertyNames(Object.getPrototypeOf(t));e.forEach(function(r){typeof t[r]=="function"&&(t[r]=t[r].bind(t))})}var Cr=function(t){gt(r,t);var e=Og(r);function r(){var n,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;if(ne(this,r),n=e.call(this),Er&&Me.call(ue(n)),n.options=gs(o),n.services={},n.logger=me,n.modules={external:[]},Cg(ue(n)),a&&!n.isInitialized&&!o.isClone){if(!n.options.initImmediate)return n.init(o,a),Ye(n,ue(n));setTimeout(function(){n.init(o,a)},0)}return n}return oe(r,[{key:"init",value:function(){var o=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;typeof a=="function"&&(i=a,a={}),!a.defaultNS&&a.defaultNS!==!1&&a.ns&&(typeof a.ns=="string"?a.defaultNS=a.ns:a.ns.indexOf("translation")<0&&(a.defaultNS=a.ns[0]));var s=ms();this.options=de(de(de({},s),this.options),gs(a)),this.options.compatibilityAPI!=="v1"&&(this.options.interpolation=de(de({},s.interpolation),this.options.interpolation)),a.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=a.keySeparator),a.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=a.nsSeparator);function u(m){return m?typeof m=="function"?new m:m:null}if(!this.options.isClone){this.modules.logger?me.init(u(this.modules.logger),this.options):me.init(null,this.options);var c;this.modules.formatter?c=this.modules.formatter:typeof Intl<"u"&&(c=_g);var f=new us(this.options);this.store=new pg(this.options.resources,this.options);var l=this.services;l.logger=me,l.resourceStore=this.store,l.languageUtils=f,l.pluralResolver=new bg(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(l.formatter=u(c),l.formatter.init(l,this.options),this.options.interpolation.format=l.formatter.format.bind(l.formatter)),l.interpolator=new xg(this.options),l.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},l.backendConnector=new Tg(u(this.modules.backend),l.resourceStore,l,this.options),l.backendConnector.on("*",function(m){for(var h=arguments.length,O=new Array(h>1?h-1:0),g=1;g<h;g++)O[g-1]=arguments[g];o.emit.apply(o,[m].concat(O))}),this.modules.languageDetector&&(l.languageDetector=u(this.modules.languageDetector),l.languageDetector.init&&l.languageDetector.init(l,this.options.detection,this.options)),this.modules.i18nFormat&&(l.i18nFormat=u(this.modules.i18nFormat),l.i18nFormat.init&&l.i18nFormat.init(this)),this.translator=new ss(this.services,this.options),this.translator.on("*",function(m){for(var h=arguments.length,O=new Array(h>1?h-1:0),g=1;g<h;g++)O[g-1]=arguments[g];o.emit.apply(o,[m].concat(O))}),this.modules.external.forEach(function(m){m.init&&m.init(o)})}if(this.format=this.options.interpolation.format,i||(i=Or),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var p=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);p.length>0&&p[0]!=="dev"&&(this.options.lng=p[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined");var d=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];d.forEach(function(m){o[m]=function(){var h;return(h=o.store)[m].apply(h,arguments)}});var y=["addResource","addResources","addResourceBundle","removeResourceBundle"];y.forEach(function(m){o[m]=function(){var h;return(h=o.store)[m].apply(h,arguments),o}});var w=Gt(),b=function(){var h=function(g,v){o.isInitialized&&!o.initializedStoreOnce&&o.logger.warn("init: i18next is already initialized. You should call init just once!"),o.isInitialized=!0,o.options.isClone||o.logger.log("initialized",o.options),o.emit("initialized",o.options),w.resolve(v),i(g,v)};if(o.languages&&o.options.compatibilityAPI!=="v1"&&!o.isInitialized)return h(null,o.t.bind(o));o.changeLanguage(o.options.lng,h)};return this.options.resources||!this.options.initImmediate?b():setTimeout(b,0),w}},{key:"loadResources",value:function(o){var a=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Or,s=i,u=typeof o=="string"?o:this.language;if(typeof o=="function"&&(s=o),!this.options.resources||this.options.partialBundledLanguages){if(u&&u.toLowerCase()==="cimode")return s();var c=[],f=function(d){if(d){var y=a.services.languageUtils.toResolveHierarchy(d);y.forEach(function(w){c.indexOf(w)<0&&c.push(w)})}};if(u)f(u);else{var l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.forEach(function(p){return f(p)})}this.options.preload&&this.options.preload.forEach(function(p){return f(p)}),this.services.backendConnector.load(c,this.options.ns,function(p){!p&&!a.resolvedLanguage&&a.language&&a.setResolvedLanguage(a.language),s(p)})}else s(null)}},{key:"reloadResources",value:function(o,a,i){var s=Gt();return o||(o=this.languages),a||(a=this.options.ns),i||(i=Or),this.services.backendConnector.reload(o,a,function(u){s.resolve(),i(u)}),s}},{key:"use",value:function(o){if(!o)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!o.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return o.type==="backend"&&(this.modules.backend=o),(o.type==="logger"||o.log&&o.warn&&o.error)&&(this.modules.logger=o),o.type==="languageDetector"&&(this.modules.languageDetector=o),o.type==="i18nFormat"&&(this.modules.i18nFormat=o),o.type==="postProcessor"&&bs.addPostProcessor(o),o.type==="formatter"&&(this.modules.formatter=o),o.type==="3rdParty"&&this.modules.external.push(o),this}},{key:"setResolvedLanguage",value:function(o){if(!(!o||!this.languages)&&!(["cimode","dev"].indexOf(o)>-1))for(var a=0;a<this.languages.length;a++){var i=this.languages[a];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}},{key:"changeLanguage",value:function(o,a){var i=this;this.isLanguageChangingTo=o;var s=Gt();this.emit("languageChanging",o);var u=function(p){i.language=p,i.languages=i.services.languageUtils.toResolveHierarchy(p),i.resolvedLanguage=void 0,i.setResolvedLanguage(p)},c=function(p,d){d?(u(d),i.translator.changeLanguage(d),i.isLanguageChangingTo=void 0,i.emit("languageChanged",d),i.logger.log("languageChanged",d)):i.isLanguageChangingTo=void 0,s.resolve(function(){return i.t.apply(i,arguments)}),a&&a(p,function(){return i.t.apply(i,arguments)})},f=function(p){!o&&!p&&i.services.languageDetector&&(p=[]);var d=typeof p=="string"?p:i.services.languageUtils.getBestMatchFromCodes(p);d&&(i.language||u(d),i.translator.language||i.translator.changeLanguage(d),i.services.languageDetector&&i.services.languageDetector.cacheUserLanguage&&i.services.languageDetector.cacheUserLanguage(d)),i.loadResources(d,function(y){c(y,d)})};return!o&&this.services.languageDetector&&!this.services.languageDetector.async?f(this.services.languageDetector.detect()):!o&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(f):this.services.languageDetector.detect(f):f(o),s}},{key:"getFixedT",value:function(o,a,i){var s=this,u=function c(f,l){var p;if(G(l)!=="object"){for(var d=arguments.length,y=new Array(d>2?d-2:0),w=2;w<d;w++)y[w-2]=arguments[w];p=s.options.overloadTranslationOptionHandler([f,l].concat(y))}else p=de({},l);p.lng=p.lng||c.lng,p.lngs=p.lngs||c.lngs,p.ns=p.ns||c.ns,p.keyPrefix=p.keyPrefix||i||c.keyPrefix;var b=s.options.keySeparator||".",m;return p.keyPrefix&&Array.isArray(f)?m=f.map(function(h){return"".concat(p.keyPrefix).concat(b).concat(h)}):m=p.keyPrefix?"".concat(p.keyPrefix).concat(b).concat(f):f,s.t(m,p)};return typeof o=="string"?u.lng=o:u.lngs=o,u.ns=a,u.keyPrefix=i,u}},{key:"t",value:function(){var o;return this.translator&&(o=this.translator).translate.apply(o,arguments)}},{key:"exists",value:function(){var o;return this.translator&&(o=this.translator).exists.apply(o,arguments)}},{key:"setDefaultNamespace",value:function(o){this.options.defaultNS=o}},{key:"hasLoadedNamespace",value:function(o){var a=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var s=this.resolvedLanguage||this.languages[0],u=this.options?this.options.fallbackLng:!1,c=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;var f=function(d,y){var w=a.services.backendConnector.state["".concat(d,"|").concat(y)];return w===-1||w===2};if(i.precheck){var l=i.precheck(this,f);if(l!==void 0)return l}return!!(this.hasResourceBundle(s,o)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||f(s,o)&&(!u||f(c,o)))}},{key:"loadNamespaces",value:function(o,a){var i=this,s=Gt();return this.options.ns?(typeof o=="string"&&(o=[o]),o.forEach(function(u){i.options.ns.indexOf(u)<0&&i.options.ns.push(u)}),this.loadResources(function(u){s.resolve(),a&&a(u)}),s):(a&&a(),Promise.resolve())}},{key:"loadLanguages",value:function(o,a){var i=Gt();typeof o=="string"&&(o=[o]);var s=this.options.preload||[],u=o.filter(function(c){return s.indexOf(c)<0});return u.length?(this.options.preload=s.concat(u),this.loadResources(function(c){i.resolve(),a&&a(c)}),i):(a&&a(),Promise.resolve())}},{key:"dir",value:function(o){if(o||(o=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!o)return"rtl";var a=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services&&this.services.languageUtils||new us(ms());return a.indexOf(i.getLanguagePartFromCode(o))>-1||o.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var o=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Or,s=de(de(de({},this.options),a),{isClone:!0}),u=new r(s);(a.debug!==void 0||a.prefix!==void 0)&&(u.logger=u.logger.clone(a));var c=["store","services","language"];return c.forEach(function(f){u[f]=o[f]}),u.services=de({},this.services),u.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u.translator=new ss(u.services,u.options),u.translator.on("*",function(f){for(var l=arguments.length,p=new Array(l>1?l-1:0),d=1;d<l;d++)p[d-1]=arguments[d];u.emit.apply(u,[f].concat(p))}),u.init(s,i),u.translator.options=u.options,u.translator.backendConnector.services.utils={hasLoadedNamespace:u.hasLoadedNamespace.bind(u)},u}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),r}(Me);pe(Cr,"createInstance",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new Cr(t,e)});var W=Cr.createInstance();W.createInstance=Cr.createInstance;var ZP=W.createInstance,XP=W.dir,eT=W.init,tT=W.loadResources,rT=W.reloadResources,nT=W.use,oT=W.changeLanguage,aT=W.getFixedT,iT=W.t,sT=W.exists,uT=W.setDefaultNamespace,cT=W.hasLoadedNamespace,lT=W.loadNamespaces,fT=W.loadLanguages;var xs=U(K());function ws(t){return xs.default.storage.local.get(t)}var ge=U(K());async function Rr({prompt:t,windowId:e}){let n=(await ge.default.tabs.query({url:"https://chat.openai.com/chat*",windowId:e}))[0];n||(n=await ge.default.tabs.create({active:!0,url:"https://chat.openai.com",windowId:e}),await new Promise(o=>{let a=(i,s,u)=>{i==n.id&&s.status=="complete"&&(o(),ge.default.tabs.onUpdated.removeListener(a))};ge.default.tabs.onUpdated.addListener(a)})),ge.default.tabs.update(n.id,{active:!0}),ge.default.tabs.sendMessage(n.id,{type:"automate-send-prompt",prompt:t}),await new Promise(o=>{let a=0,i=(s,u)=>{if(u.tab?.id===n.id)switch(s.type){case"loaded":a+=1,a<2&&ge.default.tabs.sendMessage(n.id,{type:"automate-send-prompt",prompt:t});return;case"automate-send-prompt-done":ge.default.runtime.onMessage.removeListener(i),o();return}};ge.default.runtime.onMessage.addListener(i),setTimeout(o,1e3*60)})}var L=U(K());var ks=U(Bn());var Cs=U(K());function Ir(t){let e,r,n,o,a,i,s;return u(),{feed:c,reset:u};function u(){e=!0,r="",n=0,o=-1,a=void 0,i=void 0,s=""}function c(l){r=r?r+l:l,e&&jg(r)&&(r=r.slice(Os.length)),e=!1;let p=r.length,d=0,y=!1;for(;d<p;){y&&(r[d]===`
`&&++d,y=!1);let w=-1,b=o,m;for(let h=n;w<0&&h<p;++h)m=r[h],m===":"&&b<0?b=h-d:m==="\r"?(y=!0,w=h-d):m===`
`&&(w=h-d);if(w<0){n=p-d,o=b;break}else n=0,o=-1;f(r,d,b,w),d+=w+1}d===p?r="":d>0&&(r=r.slice(d))}function f(l,p,d,y){if(y===0){s.length>0&&(t({type:"event",id:a,event:i||void 0,data:s.slice(0,-1)}),s="",a=void 0),i=void 0;return}let w=d<0,b=l.slice(p,p+(w?y:d)),m=0;w?m=y:l[p+d+1]===" "?m=d+2:m=d+1;let h=p+m,O=y-m,g=l.slice(h,h+O).toString();if(b==="data")s+=g?"".concat(g,`
`):`
`;else if(b==="event")i=g;else if(b==="id"&&!g.includes("\0"))a=g;else if(b==="retry"){let v=parseInt(g,10);Number.isNaN(v)||t({type:"reconnect-interval",value:v})}}}var Os=[239,187,191];function jg(t){return Os.every((e,r)=>t.charCodeAt(r)===e)}async function*jr(t){let e=t.getReader();try{for(;;){let{done:r,value:n}=await e.read();if(r)return;yield n}}finally{e.releaseLock()}}async function De(t,e,r=!1){let{onMessage:n,...o}=e,i=await(r?Fe:fetch)(t,o);if(!i.ok){let u=await i.json().catch(()=>({}));throw new Error(Nt(u)?`${i.status} ${i.statusText}`:JSON.stringify(u))}let s=Ir(u=>{u.type==="event"&&n(u.data)});for await(let u of jr(i.body)){let c=new TextDecoder().decode(u);s.feed(c)}}var vt="ChatGPT Webapp",Lg=`${vt}: error_chatgpt_auth`;async function Wn(t,e,r,n){let o={method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}};return n&&(o.body=JSON.stringify(n)),Fe(`https://chat.openai.com/backend-api${r}`,o)}async function Es(t,e){await Wn(t,"POST","/conversation/message_feedback",e)}async function Ng(t,e,r){await Wn(t,"PATCH",`/conversation/${e}`,r)}async function Rs(t){let e;return t?e=t:e=await he(),Wn(e,"GET","/models",null).then(r=>r.json())}var qn="accessToken",Gn=new ks.default(10*1e3);async function Vn(){if(Gn.get(qn))return Gn.get(qn);let t=null;try{t=await fetch(je.openaiApiSession)}catch(n){throw new Error(`${vt}: ${n.message}`)}let e=Lg;if(t?.status===403)throw new Error(e);let r=await t?.json().catch(()=>({}));if(!r.accessToken)throw new Error(e);return Gn.set(qn,r.accessToken),r.accessToken}async function Mg(t){try{return(await Cs.default.storage.local.get({selectWebAppModel:"gpt-4"})).selectWebAppModel}catch{return null}}var Lr=class{constructor(e){this.token=e;this.token=e}async generateAnswer(e){let r,n=Promise.resolve(),o=async()=>{try{await n}catch{}r&&(await Ng(this.token,r,{is_visible:!1}),r="")},a=Array.isArray(e.prompt)?e.prompt.map(s=>({id:X(),role:s.role,content:{content_type:"text",parts:[s.content]}})):[{id:X(),role:"user",content:{content_type:"text",parts:[e.prompt]}}],i=()=>{i=null,e.onEvent({type:"done"}),o()};return n=De("https://chat.openai.com/backend-api/conversation",{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify({action:"next",messages:a,model:await Mg(this.token)||"text-davinci-002-render",parent_message_id:X()}),onMessage(s){if(s==="[DONE]"){i?.();return}let u;try{u=JSON.parse(s)}catch{return}let c=u.message?.content?.parts?.[0];c&&(r=u.conversation_id,e.onEvent({type:"answer",data:{text:c,messageId:u.message.id,conversationId:""}}))}},!0).catch(s=>{let u=s.message;try{let c=JSON.parse(u);u=c.message||c.msg||c.error?.message||c.detail?.message||u}catch{}throw new Error(`${vt}: ${u}`)}).finally(()=>{i?.()}),{cleanup:o}}};var ie=0,Wt=!1;L.default.storage.local.get({guardChatgptTabId:0}).then(({guardChatgptTabId:t})=>{ie==0&&(ie=t),Wt=t!=0});async function Is(){let t=null;try{t=await L.default.tabs.get(ie),await L.default.tabs.update(t.id,{active:!0})}catch{}t||(t=await L.default.tabs.create({url:je.openaiChat,pinned:!0,active:!0}));let e=t.id;await L.default.storage.local.set({guardChatgptTabId:e}),ie=e,Wt=!0,await new Promise(r=>{let n=(o,a)=>{switch(o.type){case"loaded":a.tab?.id==e&&L.default.tabs.sendMessage(e,{type:"guard-session-activate"});break;case"guard-session-activated":L.default.runtime.onMessage.removeListener(n),r();break}};L.default.runtime.onMessage.addListener(n),setTimeout(()=>r(),1e3*40)})}async function Dg(){let t=await L.default.tabs.create({url:je.openaiChat,pinned:!0,active:!1});return await L.default.storage.local.set({guardChatgptTabId:t.id}),ie=t.id,Wt=!0,t}async function Fg(){let t="https://chat.openai.com/*",e=await L.default.tabs.query({pinned:!0,url:t});if(e.length>0){let r=e[0];return ie=r.id,await L.default.tabs.reload(r.id),r}return null}async function Kn(){let t=null;try{t=await L.default.tabs.get(ie),/chat\.openai\.com/.test(t.url||"")?await L.default.tabs.reload(t.id):t=await L.default.tabs.update(t.id,{url:je.openaiChat})}catch{}t||(t=await Fg()),t||(t=await Dg());let e=t?.id||0;await new Promise(r=>{let n=(o,a)=>{switch(o.type){case"loaded":a.tab?.id==e&&L.default.tabs.sendMessage(e,{type:"guard-session-activate"});break;case"guard-session-activated":L.default.runtime.onMessage.removeListener(n),r();break;case"guard-session-logout":throw Error("")}};L.default.runtime.onMessage.addListener(n),setTimeout(()=>r(),1e3*40)})}async function he({onRefresh:t,throwGuideError:e}={}){let r=null;try{r=await Nr(ie,je.openaiApiSession)}catch{}if(r?.status===403||!r){if(!Wt&&e)throw Error(`${vt}: error_chatgpt_session_timeout`);t?.(),await Kn(),r=await Nr(ie,je.openaiApiSession)}return(await r.json().catch(()=>({}))).accessToken}async function Nr(t,e,r){let n=L.default.tabs.connect(t,{name:"guard-proxy"}),o=null,a=null,i=new Promise((d,y)=>{o=d,a=y}),s;n.onDisconnect.addListener(()=>{a(new Error("proxy fetch aborted")),s?.close()}),r?.signal?.addEventListener("abort",()=>{s?.close(),n.disconnect()});let u={type:"guard-proxy-request",key:Date.now()+"",url:e,options:r};n.postMessage(u);let c=new ReadableStream({start(d){s=d},cancel(){n.disconnect()}}),f=setTimeout(()=>a(new Error("connect timeout")),1e3*1),l=d=>{switch(d.type){case"guard-proxy-request-received":clearTimeout(f);break;case"guard-proxy-response":o(new Response(c,d.options));break;case"guard-proxy-response-chunk":s.enqueue(new TextEncoder().encode(d.value)),d.done&&(s.close(),n.onMessage.removeListener(l),n.disconnect());break;case"guard-proxy-response-error":n.onMessage.removeListener(l),n.disconnect(),a(new Error(d.error)),s.close();break}};return n.onMessage.addListener(l),await i}async function Fe(t,e){let r=null;try{await L.default.tabs.get(ie)}catch{await Kn()}try{r=await Nr(ie,t,e)}catch{}if(!r||r.status==403){if(!Wt)throw Error(`${vt}: error_chatgpt_session_timeout`);await Kn(),r=await Nr(ie,t,e)}return r}var Ug=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(t=>[t.name,t]),$g=new Map(Ug),zn=$g;var Bg=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],Hn=Symbol(".toJSON was called"),qg=t=>{t[Hn]=!0;let e=t.toJSON();return delete t[Hn],e},Gg=t=>zn.get(t)??Error,Ls=({from:t,seen:e,to:r,forceEnumerable:n,maxDepth:o,depth:a,useToJSON:i,serialize:s})=>{if(!r)if(Array.isArray(t))r=[];else if(!s&&js(t)){let c=Gg(t.name);r=new c}else r={};if(e.push(t),a>=o)return r;if(i&&typeof t.toJSON=="function"&&t[Hn]!==!0)return qg(t);let u=c=>Ls({from:c,seen:[...e],forceEnumerable:n,maxDepth:o,depth:a,useToJSON:i,serialize:s});for(let[c,f]of Object.entries(t)){if(typeof Buffer=="function"&&Buffer.isBuffer(f)){r[c]="[object Buffer]";continue}if(f!==null&&typeof f=="object"&&typeof f.pipe=="function"){r[c]="[object Stream]";continue}if(typeof f!="function"){if(!f||typeof f!="object"){r[c]=f;continue}if(!e.includes(t[c])){a++,r[c]=u(t[c]);continue}r[c]="[Circular]"}}for(let{property:c,enumerable:f}of Bg)typeof t[c]<"u"&&t[c]!==null&&Object.defineProperty(r,c,{value:js(t[c])?u(t[c]):t[c],enumerable:n?!0:f,configurable:!0,writable:!0});return r};function Mr(t,e={}){let{maxDepth:r=Number.POSITIVE_INFINITY,useToJSON:n=!0}=e;return typeof t=="object"&&t!==null?Ls({from:t,seen:[],forceEnumerable:!0,maxDepth:r,depth:0,useToJSON:n,serialize:!0}):typeof t=="function"?`[Function: ${t.name??"anonymous"}]`:t}function js(t){return!!t&&typeof t=="object"&&"name"in t&&"message"in t&&"stack"in t}var Wg=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Vg=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Kg=/^\s*["[{]|^\s*-?\d[\d.]{0,14}\s*$/;function zg(t,e){if(t!=="__proto__"&&!(t==="constructor"&&e&&typeof e=="object"&&"prototype"in e))return e}function Ns(t,e={}){if(typeof t!="string")return t;let r=t.toLowerCase().trim();if(r==="true")return!0;if(r==="false")return!1;if(r==="null")return null;if(r==="nan")return Number.NaN;if(r==="infinity")return Number.POSITIVE_INFINITY;if(r!=="undefined"){if(!Kg.test(t)){if(e.strict)throw new SyntaxError("Invalid JSON");return t}try{return Wg.test(t)||Vg.test(t)?JSON.parse(t,zg):JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}}var qT=String.fromCharCode;var Hg=/#/g,Jg=/&/g;var Qg=/=/g;var Ds=/\+/g,Yg=/%5e/gi,Zg=/%60/gi;var Xg=/%7c/gi;var eh=/%20/gi;function th(t){return encodeURI(""+t).replace(Xg,"|")}function Qn(t){return th(typeof t=="string"?t:JSON.stringify(t)).replace(Ds,"%2B").replace(eh,"+").replace(Hg,"%23").replace(Jg,"%26").replace(Zg,"`").replace(Yg,"^")}function Jn(t){return Qn(t).replace(Qg,"%3D")}function Fs(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function rh(t){return Fs(t.replace(Ds," "))}function nh(t=""){let e={};t[0]==="?"&&(t=t.slice(1));for(let r of t.split("&")){let n=r.match(/([^=]+)=?(.*)/)||[];if(n.length<2)continue;let o=Fs(n[1]);if(o==="__proto__"||o==="constructor")continue;let a=rh(n[2]||"");typeof e[o]<"u"?Array.isArray(e[o])?e[o].push(a):e[o]=[e[o],a]:e[o]=a}return e}function oh(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(r=>`${Jn(t)}=${Qn(r)}`).join("&"):`${Jn(t)}=${Qn(e)}`:Jn(t)}function ah(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>oh(e,t[e])).join("&")}var ih=/^\w{2,}:([/\\]{1,2})/,sh=/^\w{2,}:([/\\]{2})?/,uh=/^([/\\]\s*){2,}[^/\\]/;function Us(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?ih.test(t):sh.test(t)||(e.acceptRelative?uh.test(t):!1)}var ch=/\/$|\/\?/;function Yn(t="",e=!1){return e?ch.test(t):t.endsWith("/")}function lh(t="",e=!1){if(!e)return(Yn(t)?t.slice(0,-1):t)||"/";if(!Yn(t,!0))return t||"/";let[r,...n]=t.split("?");return(r.slice(0,-1)||"/")+(n.length>0?`?${n.join("?")}`:"")}function fh(t="",e=!1){if(!e)return t.endsWith("/")?t:t+"/";if(Yn(t,!0))return t||"/";let[r,...n]=t.split("?");return r+"/"+(n.length>0?`?${n.join("?")}`:"")}function ph(t=""){return t.startsWith("/")}function dh(t=""){return(ph(t)?t.slice(1):t)||"/"}function $s(t,e){if(mh(e)||Us(t))return t;let r=lh(e);return t.startsWith(r)?t:hh(r,t)}function Bs(t,e){let r=qs(t),n={...nh(r.search),...e};return r.search=ah(n),yh(r)}function mh(t){return!t||t==="/"}function gh(t){return t&&t!=="/"}function hh(t,...e){let r=t||"";for(let n of e.filter(o=>gh(o)))r=r?fh(r)+dh(n):n;return r}function qs(t="",e){if(!Us(t,{acceptRelative:!0}))return e?qs(e+t):Ms(t);let[r="",n,o=""]=(t.replace(/\\/g,"/").match(/([^/:]+:)?\/\/([^/@]+@)?(.*)/)||[]).splice(1),[a="",i=""]=(o.match(/([^#/?]*)(.*)?/)||[]).splice(1),{pathname:s,search:u,hash:c}=Ms(i.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:r,auth:n?n.slice(0,Math.max(0,n.length-1)):"",host:a,pathname:s,search:u,hash:c}}function Ms(t=""){let[e="",r="",n=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:r,hash:n}}function yh(t){let e=t.pathname+(t.search?(t.search.startsWith("?")?"":"?")+t.search:"")+t.hash;return t.protocol?t.protocol+"//"+(t.auth?t.auth+"@":"")+t.host+e:e}var Zn=class extends Error{constructor(){super(...arguments),this.name="FetchError"}};function vh(t,e,r){let n="";e&&(n=e.message),t&&r?n=`${n} (${r.status} ${r.statusText} (${t.toString()}))`:t&&(n=`${n} (${t.toString()})`);let o=new Zn(n);return Object.defineProperty(o,"request",{get(){return t}}),Object.defineProperty(o,"response",{get(){return r}}),Object.defineProperty(o,"data",{get(){return r&&r._data}}),Object.defineProperty(o,"status",{get(){return r&&r.status}}),Object.defineProperty(o,"statusText",{get(){return r&&r.statusText}}),Object.defineProperty(o,"statusCode",{get(){return r&&r.status}}),Object.defineProperty(o,"statusMessage",{get(){return r&&r.statusText}}),o}var bh=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function Gs(t="GET"){return bh.has(t.toUpperCase())}function xh(t){if(t===void 0)return!1;let e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}var wh=new Set(["image/svg","application/xml","application/xhtml","application/html"]),_h=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function Ah(t=""){if(!t)return"json";let e=t.split(";").shift()||"";return _h.test(e)?"json":wh.has(e)||e.startsWith("text/")?"text":"blob"}var Sh=new Set([408,409,425,429,500,502,503,504]);function Xn(t){let{fetch:e,Headers:r}=t;function n(i){let s=i.error&&i.error.name==="AbortError"||!1;if(i.options.retry!==!1&&!s){let c;typeof i.options.retry=="number"?c=i.options.retry:c=Gs(i.options.method)?0:1;let f=i.response&&i.response.status||500;if(c>0&&Sh.has(f))return o(i.request,{...i.options,retry:c-1})}let u=vh(i.request,i.error,i.response);throw Error.captureStackTrace&&Error.captureStackTrace(u,o),u}let o=async function(s,u={}){let c={request:s,options:{...t.defaults,...u},response:void 0,error:void 0};c.options.onRequest&&await c.options.onRequest(c),typeof c.request=="string"&&(c.options.baseURL&&(c.request=$s(c.request,c.options.baseURL)),(c.options.query||c.options.params)&&(c.request=Bs(c.request,{...c.options.params,...c.options.query})),c.options.body&&Gs(c.options.method)&&xh(c.options.body)&&(c.options.body=typeof c.options.body=="string"?c.options.body:JSON.stringify(c.options.body),c.options.headers=new r(c.options.headers),c.options.headers.has("content-type")||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json"))),c.response=await e(c.request,c.options).catch(async l=>(c.error=l,c.options.onRequestError&&await c.options.onRequestError(c),n(c)));let f=(c.options.parseResponse?"json":c.options.responseType)||Ah(c.response.headers.get("content-type")||"");if(f==="json"){let l=await c.response.text(),p=c.options.parseResponse||Ns;c.response._data=p(l)}else f==="stream"?c.response._data=c.response.body:c.response._data=await c.response[f]();return c.options.onResponse&&await c.options.onResponse(c),c.response.status>=400&&c.response.status<600?(c.options.onResponseError&&await c.options.onResponseError(c),n(c)):c.response},a=function(s,u){return o(s,u).then(c=>c._data)};return a.raw=o,a.native=e,a.create=(i={})=>Xn({...t,defaults:{...t.defaults,...i}}),a}var Ws=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),Ph=Ws.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),Th=Ws.Headers,Ze=Xn({fetch:Ph,Headers:Th});var te=class{option;conversation_id;message_id;text;abortMap={};sendChat(e){return this.option=e,this._sendChat(e)}async abortChat(e){this.abortMap[e]?.abort?.(),delete this.abortMap[e]}sendAnswering(e={}){this.option.onEvent({type:"chat-answering",data:{conversation_id:this.conversation_id,message_id:this.message_id,originId:this.option.originId,text:this.text,...e}})}sendAnswerEnd(e={}){this.option.onEvent({type:"chat-answer-end",data:{conversation_id:this.conversation_id,message_id:this.message_id,originId:this.option.originId,...e}})}sendAnswerErr(e){this.option.onEvent({type:"chat-answer-error",data:{originId:this.option.originId,text:pt(e.error?.msg)&&e.error.msg||pt(e.error)&&e.error||e.error?.toString?.()||e.error||"unknown error",position:e?.position??e.error?.position??"unknown",...e,error:Mr(e.error)}})}};var V=class extends Error{constructor(r,n,o){super();this.message=r;this.code=n;this.position=o}};function Vs(t,e){return new RegExp(`"${t}":"([^"]+)"`).exec(e)?.[1]}async function Ks(){let t=await Ze("https://bard.google.com/faq"),e=Vs("SNlM0e",t),r=Vs("cfb2h",t);return{atValue:e,blValue:r}}function zs(t){let e=JSON.parse(t.split(`
`)[3]),r=JSON.parse(e[0][2]);if(!r)throw new V("Bard is not available.","no access","bard-token");return{text:r[0][0],ids:[...r[1],r[4][0][0]]}}function Oh(){return Math.floor(Math.random()*9e5)+1e5}var Vt=class extends te{async _sendChat(e){let r=e.parent_message_id?JSON.parse(e.parent_message_id):["","",""],n=e.conversation_id?JSON.parse(e.conversation_id):await Ks();this.conversation_id=JSON.stringify(n),this.message_id="";let o=new AbortController;this.abortMap[e.originId]=o;let a=await Ze("https://bard.google.com/_/BardChatUi/data/assistant.lamda.BardFrontendService/StreamGenerate",{method:"POST",signal:o.signal,query:{bl:n.blValue,_reqid:Oh(),rt:"c"},body:new URLSearchParams({at:n.atValue,"f.req":JSON.stringify([null,`[[${JSON.stringify(e.content)}],null,${JSON.stringify(r)}]`])}),parseResponse:i=>i}).catch(i=>{this.sendAnswerErr({error:i,code:"api error",position:i?.position??"bard"})});try{let{text:i,ids:s}=zs(a);this.message_id=JSON.stringify(s),this.text=i,this.sendAnswering(),this.sendAnswerEnd()}catch(i){this.sendAnswerErr({error:i,code:i?.code||"system error",position:i?.position??"bard-parser message"})}}};var Al=U(bl());function _v(){return`13.${Mt(104,107)}.${Mt(0,255)}.${Mt(0,255)}`}var Do="https://www.bing.com/turing/conversation/create";async function xl(){let t={"x-ms-client-request-id":X(),"x-ms-useragent":"azsdk-js-api-client-factory/1.0.0-beta.1 core-rest-pipeline/1.10.0 OS/Win32"},e;try{if(e=await Ze(Do,{headers:t,redirect:"error"}),!e.result)throw new V("Invalid response","api error","bing-token")}catch{if(e=await Ze(Do,{headers:{...t,"x-forwarded-for":_v()},redirect:"error"}),!e)throw new V(`Failed to fetch (${Do})`,"api error","bing-token retry create")}if(e.result.value!=="Success"){let r=`${e.result.value}: ${e.result.message}`;throw e.result.value==="UnauthorizedRequest"?new V(r,"no access","bing-token"):e.result.value==="Forbidden"?new V(r,"no access","bing-token"):new Error(r)}return e}function _l(t){if(t.messageType==="InternalSearchQuery")return t.text;for(let e of t.adaptiveCards)for(let r of e.body)if(r.type==="TextBlock")return r.text;return""}var wl=String.fromCharCode(30),Fo={packMessage(t){return`${JSON.stringify(t)}${wl}`},unpackMessage(t){return t.toString().split(wl).filter(Boolean).map(e=>JSON.parse(e))}};var Av={["balanced"]:"harmonyv3",["creative"]:"h3imaginative",["precise"]:"h3precise"},Yt=class extends te{wsp;buildChatRequest(e,r){return{arguments:[{source:"cib",optionsSets:["deepleo","nlu_direct_response_filter","disable_emoji_spoken_text","responsible_ai_policy_235","enablemm","dtappid","rai253","dv3sugg",Av[e.conversationStyle]],allowedMessageTypes:["Chat","InternalSearchQuery"],isStartOfSession:e.invocationId===0,message:{author:"user",inputMethod:"Keyboard",text:r,messageType:"Chat"},conversationId:e.conversationId,conversationSignature:e.conversationSignature,participant:{id:e.clientId}}],invocationId:e.invocationId.toString(),target:"chat",type:4}}async _sendChat(e){let r=e.originId;this.message_id="",this.conversation_id=e.conversation_id||"";let n=this.conversation_id&&JSON.parse(this.conversation_id);if(!n){let[a]=await Promise.all([xl()]);n={conversationId:a.conversationId,conversationSignature:a.conversationSignature,clientId:a.clientId,invocationId:0,conversationStyle:"balanced"},this.conversation_id=JSON.stringify(n)}let o=new Al.default("wss://sydney.bing.com/sydney/ChatHub",{packMessage:Fo.packMessage,unpackMessage:Fo.unpackMessage});this.wsp=o,o.onUnpackedMessage.addListener(a=>{for(let i of a)if(JSON.stringify(i)==="{}")o.sendPacked({type:6}),o.sendPacked(this.buildChatRequest(n,e.content)),n.invocationId+=1,this.conversation_id=JSON.stringify(n);else if(i.type===6)o.sendPacked({type:6});else if(i.type===3)this.sendAnswerEnd(),o.removeAllListeners(),o.close();else if(i.type===1){let s=i.arguments[0].messages?.[0];if(!s)return;let u=_l(s);this.text=u,this.sendAnswering()}else if(i.type===2){let s=i.item.messages;s?s.some(c=>c.contentOrigin==="TurnLimiter")&&this.sendAnswerErr({text:"Sorry, you have reached chat turns limit in this conversation.",code:"custom error",error:i.item,position:"bing"}):i.item.result?this.sendAnswerErr({error:JSON.stringify(i.item.result),code:"api error",position:"bing"}):this.sendAnswerErr({error:JSON.stringify(i.item),code:"api error",position:"bing"})}}),o.onClose.addListener(()=>{this.sendAnswerEnd()}),await o.open(),o.sendPacked({protocol:"json",version:1})}async abortChat(e){this.wsp.removeAllListeners(),this.wsp.close()}};var Sl=U(Bn());var Pl={changeConversation:async(t,e)=>Fe(`https://chat.openai.com/backend-api/conversation/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await he()}`},body:JSON.stringify(e)}).then(r=>r.json()),deleteConversation:t=>Pl.changeConversation(t,{is_visible:!1}),getConversations:async()=>Fe("https://chat.openai.com/backend-api/conversations",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await he()}`}}).then(t=>t.json()),getModels:async()=>Fe("https://chat.openai.com/backend-api/models",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${await he()}`}}).then(t=>t.json())};var S1=new Sl.default(10*1e3);var tn=Pl;var Tt=class extends te{async _sendChat(e){let r=e.model||"text-davinci-002-render",n=e.parent_message_id||X(),o=X();this.conversation_id=e.conversation_id||"",this.message_id="";let a=e.originId;if(e.TTL=e.TTL??2,!e.TTL--){let l="Too many loop sending times, please resend"}let i=!e.conversation_id,s=!1,u="";try{u=await he()}catch(l){this.sendAnswerErr({error:l,code:l?.code||"system error",position:l?.position??"chatGPT-token"});return}let c=!1,f=new AbortController;this.abortMap[e.originId]=f,await De("https://chat.openai.com/backend-api/conversation",{method:"POST",signal:f.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({action:"next",messages:[...e.messages?e.messages?.map?.(l=>({id:X(),role:l.role,content:{content_type:"text",parts:[l.message]}})):[],{id:o,role:"user",content:{content_type:"text",parts:[e.content]}}],model:r,parent_message_id:n}),onMessage:l=>{if(c){try{this.abortChat(a)}catch{}return}if(l==="[DONE]"){c=!0,this.sendAnswerEnd({conversation_id:""}),tn.deleteConversation(this.conversation_id);return}let p;try{p=JSON.parse(l)}catch{return}let d=p.message?.content?.parts?.[0];p.message?.author?.role=="assistant"&&(d&&s&&(this.conversation_id=p.conversation_id,this.message_id=p.message.id,this.text=d,this.sendAnswering({conversation_id:""})),d==""&&(s=!0))}},!0).catch(async l=>{this.sendAnswerErr({error:l,code:l?.code||"api error",position:l?.position??"chatGPT"})})}};async function rn(t,e){let{onMessage:r,...n}=e,o=await fetch(t,n);if(!o.ok){let i=await o.json().catch(()=>({}));throw new Error(Nt(i)?`${o.status} ${o.statusText}`:JSON.stringify(i))}let a=Ir(i=>{i.type==="event"&&r(i.data)});for await(let i of jr(o.body)){let s=new TextDecoder().decode(i);a.feed(s)}}var Zt=class extends te{config;constructor(e){super(),this.config=e.configs["gpt3"]}async _sendChat(e){let r=e.model||this.config.model||"gpt-3.5-turbo",n=e.originId;this.conversation_id=e.conversation_id||"",this.message_id="";let o=r==="gpt-3.5-turbo",a="",i=Le(this.config.enableCustomURL&&this.config.customURL?this.config.customURL:"https://api.openai.com","/v1/chat/completions"),s={model:r,stream:!0};s.messages=[...e.messages?e.messages?.map?.(c=>({role:c.role,content:c.message})):[],{role:"user",content:e.content}];let u=new AbortController;this.abortMap[e.originId]=u,await rn(i,{method:"POST",signal:u.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},body:JSON.stringify(s),onMessage:c=>{if(c==="[DONE]"){this.sendAnswerEnd({conversation_id:""});return}let f;try{f=JSON.parse(c);let l=f.choices[0].delta.content;if(l==="<|im_end|>"||l==="<|im_sep|>"||!l)return;this.conversation_id=f.id,this.message_id=f.id,a+=l,this.text=a,this.sendAnswering({conversation_id:""})}catch(l){this.sendAnswerErr({error:new V(l.message,"system error","openai-message parse"),code:"system error",position:"openai-parser message"});return}}}).catch(c=>{this.sendAnswerErr({error:c,code:c?.code||"api error",position:c?.position??"openai"})})}};var Xt=class extends te{config;token;loginCount=0;constructor(e){super(),this.config=e.configs["gpt3"]}async _sendChat(e){let r="",n=e.originId;this.conversation_id=e.conversation_id,this.message_id="";let o={};if(e.messages?.length&&!e.conversation_id)try{let i=await re(`${q.api}/v1/conversation/upload`,{app_name:ee,app_version:ze,ts_name:Intl.DateTimeFormat().resolvedOptions().timeZone,messages:e.messages.map(s=>({role:s.role,content:s.message})),...this.conversation_id?{cid:this.conversation_id}:{}});this.conversation_id=i?.cid??this.conversation_id}catch(i){throw this.sendAnswerErr({error:i,code:i?.code||"api error",position:i?.position??"sider-create cid"}),i}let a=new AbortController;this.abortMap[e.originId]=a,await rn(`${q.api}/v1/completion/text`,{method:"POST",signal:a.signal,headers:{"Content-Type":"application/json",Authorization:(await Qe()).token},body:JSON.stringify({prompt:e.content,stream:!0,ts_name:Intl.DateTimeFormat().resolvedOptions().timeZone,app_name:ee,app_version:ze,...this.conversation_id?{cid:this.conversation_id}:{}}),onMessage:i=>{if(i=="[DONE]"){this.sendAnswerEnd({otherData:o});return}let s=JSON.parse(i);if(s.code!==0)throw new V(s?.msg||i,"api error","sider");this.conversation_id=s.data.cid,this.message_id=s.data.message_id;let{total:u,remain:c,remain_period:f,extra_quota:l}=s.data;o={total:u,remain:c,remain_period:f,extra_quota:l};let p=s.data.text;p&&(r+=p,this.text=r,this.sendAnswering({otherData:o}))}}).catch(i=>{throw this.sendAnswerErr({error:i,code:i?.code||"api error",position:i?.position??"sider"}),new Error(i)})}};async function Tl(t,e){let r,n=await vr(),o=!1;switch(e.target){case"openai":case"chatGPT":{o=!0,n.provider==="chatgpt"&&(r=new Tt),n.provider==="gpt3"&&(r=new Zt(n)),n.provider==="siderApi"&&(r=new Xt(n));break}case"bard":{r=new Vt;break}case"bing":{r=new Yt;break}default:r=new Tt}r.sendChat({...e,onEvent(a){t.postMessage({type:a.type,data:{...a?.data??{},sendType:o?n.provider:e.target}})}}).catch(a=>{let i={originId:e.originId,sendType:o?n.provider:e.target,error:Mr(a)};a instanceof V?t.postMessage({type:"chat-answer-error",data:{text:a.message,code:a.code||"system error",position:"base-"+a.position,...i}}):a?.msg?t.postMessage({type:"chat-answer-error",data:{text:a.msg,code:"api error",position:"base",...i}}):t.postMessage({type:"chat-answer-error",data:{text:pt(a)?a:a?.toString?.()||a,code:"system error",position:"base",...i}})}),t.onDisconnect.addListener(()=>{r.abortChat(e.originId)})}var nn=U(K());async function $o(){let t=await nn.default.storage.local.get("language");if(t.language&&t.language!=="auto")return;let e=navigator.languages;for(let r of e){r=r.replace("-","_");let n=r.split("_");n[0]=n[0].toLowerCase(),n[1]&&(n[1]=n[1].toUpperCase()),r=n.join("_");let o="";if(r in Ft?o=r:o=Object.keys(Ft).find(a=>n[0]===a.split("_")[0])||"",o){await nn.default.storage.local.set({__DONT_SYNC__:`language${Date.now()}`,language:o});return}}nn.default.storage.local.set({__DONT_SYNC__:`language${Date.now()}`,language:"en"})}var Ol=U(K());var Pv="OpenAI";async function Tv(t,e){let r=await Ol.default.storage.local.get("provider:gpt3");if(r["provider:gpt3"].apiKey){let n=r["provider:gpt3"].customURL||Ov;return fetch(n+e,{method:t,headers:{"Content-Type":"application/json",Authorization:`Bearer ${r["provider:gpt3"].apiKey}`}}).then(o=>o.json())}else return!1}async function kl(){return Tv("GET","/v1/models")}var Ov="https://api.openai.com",on=class{constructor(e,r,n){this.token=e;this.model=r;this.url=n;this.token=e,this.model=r,this.url=n}async generateAnswer(e){let r="",n=Le(this.url?this.url:"https://api.openai.com","/v1","/chat/completions"),o={model:this.model,stream:!0};return Array.isArray(e.prompt)?o.messages=e.prompt:o.messages=[{role:"user",content:e.prompt}],await De(n,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(o),onMessage(a){if(a==="[DONE]"){e.onEvent({type:"done"});return}let i;try{i=JSON.parse(a);let s=i.choices[0].delta.content;if(s==="<|im_end|>"||s==="<|im_sep|>"||!s)return;r+=s,e.onEvent({type:"answer",data:{text:r,messageId:i.id,conversationId:""}})}catch{return}}}).catch(a=>{let i=a.message;try{let s=JSON.parse(i);i=s.message||s.msg||s.error?.message||s.detail?.message||i}catch{}throw new Error(`${Pv}: ${i}`)}),{}}};var an=class{token="";refreshToken="";cid;anonymous=!0;constructor(e){this.cid=e}async getToken(){let e=await Qe();this.token=e.token,this.refreshToken=e.refreshToken,this.anonymous=e.anonymous}async generateAnswer(e){let r="";try{await this.getToken()}catch(n){let o=n.message;throw n.code===1003?o="error_sider_need_login":n.code===1006&&(o="error_sider_device_bind_account"),new Error(o)}return!this.cid&&e.historyMsg&&(this.cid=await B.uploadHistoryMsg(e.historyMsg)),await De(`${q.api}/v1/completion/text`,{method:"POST",signal:e.signal,headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify({prompt:e.prompt,stream:!0,app_name:ee,app_version:ze,tz_name:kn,cid:this.cid}),onMessage(n){if(n=="[DONE]"){e.onEvent({type:"done"});return}let o=JSON.parse(n);if(o.code!==0)throw o.code===1101?new Error("error_sider_processing"):o.code===1102?new Error("error_sider_api_limit"):o.code===1107?new Error("error_sider_api_limit2"):new Error(o?.msg||n);let a={remain:o.data.remain,total:o.data.total};Sr(a);let i=o.data.text;i&&(r+=i,e.onEvent({type:"answer",data:{text:r,messageId:"",conversationId:o.data.cid}}))}}).catch(async n=>{let o=n.message;try{let a=JSON.parse(o);if((a.code===1001||a.code===1002)&&this.refreshToken){let i={token:"",refreshToken:""};try{i=await B.refreshToken(this.refreshToken)}catch{}this.anonymous?On(i):Hi(i)}a.msg&&(o=a.msg),a.code===1003?o="error_sider_need_login":a.code===1006&&(o="error_sider_device_bind_account")}catch{}throw typeof o=="string"&&o.startsWith("504")&&(o="error_sider_timeout"),new Error(o)}),{}}};var er=U(K());var Cl=fe(async t=>{let e=await er.default.storage.local.get({promptTemplates:yr}),r=yr.reduce((n,{id:o},a)=>(n[o]=yr[a],n),{});for(let n of e.promptTemplates)n.id in r&&(n.title=t[n.id].title,n.template=t[n.id].template);er.default.storage.local.set({__DONT_SYNC__:`searchPromptTPL${Date.now()}`,...e})},200),El=fe(async(t,e)=>{let r=await er.default.storage.local.get("sidebarPromptTemplate"),n=!1;if(r.sidebarPromptTemplate||(n=!0,r.sidebarPromptTemplate=Ut),!t||!e)return;let o=Ut.reduce((a,{key:i},s)=>(a[i]=Ut[s],a),{});for(let a of r.sidebarPromptTemplate)a.key in o&&(a.title=t[a.key].title,n||a.changed===!1||a.template.trim()===e[a.key].template.trim()?(a.template=t[a.key].template,a.changed=!1):a.changed=!0);er.default.storage.local.set({__DONT_SYNC__:`sidebarPromptTPL${Date.now()}`,...r})},100);var le=U(K());var Rl={provider:"gpt3","provider:gpt3":{apiKey:"",customURL:"",enableCustomURL:!0,model:"gpt-3.5-turbo"},language:"zh_CN",theme:"light",isShowSearch:!1,triggerMode:"questionMark",selectedSearchTemplate:{id:"suggest",title:""},promptTemplates:[],submitShortcut:"Enter",sidebarShortcut:{altKey:!1,ctrlKey:!0,key:"O",keyCode:79,metaKey:!1,shiftKey:!0},sidebarLocation:"right",sidebarDisplayOption:"overlay",sidebarFab:!0,selectionSidebarFab:!0,sidebarPromptTemplate:[],translatorPrimaryTemplates:["translate","rewrite","explain"],translatorPinnedTemplates:["explain"],translatorEnable:!0,translatorHostConfig:{"fab-config.example.com":{favicon:"",enable:!0}}},Wo=Date.now();function Il(){le.default.storage.local.onChanged.addListener(t=>{if(!t.__DONT_SYNC__?.newValue)for(let[e]of Object.entries(t))e in Rl&&jl()})}var jl=fe(async()=>{if(!await Ar())return;await Ll();let e=await Ml();e["provider:gpt3"]&&(e["provider:gpt3"].apiKey=""),Rv(e,"translatorHostConfig"),"promptTemplates"in e&&(e.promptTemplates=e.promptTemplates.map(r=>({uid:r.uid||"",id:r.id}))),e.sidebarPromptTemplate&&(e.sidebarPromptTemplate=e.sidebarPromptTemplate.map(r=>r.key.startsWith("custom")?{uid:r.uid||"",key:r.key,visible:r.visible}:r.changed?r:{key:r.key,visible:r.visible})),B.setUserSettings(e),Wo=Date.now()},2e3),Ll=async()=>{let{promptTemplates:t,sidebarPromptTemplate:e}=await le.default.storage.local.get(["promptTemplates","sidebarPromptTemplate"]),r=!1;t&&(await Promise.all(t.map(async n=>{if(n.canEdit&&!n.uid){r=!0;let o=await B.createUserPrompt({type:"search",name:n.title,content:n.template});n.uid=o.id}})),r&&await le.default.storage.local.set({__DONT_SYNC__:`unsavedSearchTpl${Date.now()}`,promptTemplates:t})),r=!1,e&&(await Promise.all(e.map(async n=>{if(n.key.startsWith("custom")&&!n.uid){r=!0;let o=await B.createUserPrompt({type:"sidebar",name:n.title,content:n.template});n.uid=o.id}})),r&&await le.default.storage.local.set({__DONT_SYNC__:`unsavedSidebarTpl${Date.now()}`,sidebarPromptTemplate:e}))},Vo=fe(async()=>{await Ar()&&(await Ll(),await Cv(),await Ev(),Wo=Date.now())},1e3),kv=1e3*60*60*6,Bo=!1,Nl=fe(async()=>{if(!Bo&&Date.now()-Wo>kv){Bo=!0;try{await Vo()}catch{}Bo=!1}},3e3),qo=null,Go=null;async function Cv(){let t=await B.getUserSettings();if(!t||!Object.keys(t).length){await jl();return}let e=await Ml(),r;e["provider:gpt3"]&&(r=e["provider:gpt3"].apiKey),Iv(t,"translatorHostConfig"),"promptTemplates"in e&&delete e.promptTemplates,"promptTemplates"in t&&(qo=t.promptTemplates,delete t.promptTemplates),"sidebarPromptTemplate"in e&&delete e.sidebarPromptTemplate,"sidebarPromptTemplate"in t&&(Go=t.sidebarPromptTemplate,delete t.sidebarPromptTemplate),bn(e,t,{"provider:gpt3":{apiKey:r}}),await le.default.storage.local.set({__DONT_SYNC__:`pullFromCloud${Date.now()}`,...e})}async function Ev(){let{promptTemplates:t}=await le.default.storage.local.get("promptTemplates"),e=qo?[...qo]:t,r=e.reduce((u,c)=>{if(u[c.uid||c.id]=c,c.uid||c.id.startsWith("search"))Object.assign(c,{canEdit:!0});else{let f=t.find(l=>l.id===c.id);Object.assign(c,f)}return u},{}),n=await B.getUserPromptList("search");if(n?.List?.length){for(let u of n.List)r[u.id]?Object.assign(r[u.id],{uid:u.id,title:u.name,template:u.content,canEdit:!0,visible:!0}):e.unshift({id:u.id,uid:u.id,title:u.name,template:u.content,canEdit:!0,visible:!0});await le.default.storage.local.set({__DONT_SYNC__:`pullSearchTpl${Date.now()}`,promptTemplates:e.filter(u=>u.title)})}let{sidebarPromptTemplate:o}=await le.default.storage.local.get("sidebarPromptTemplate"),a=Go?[...Go]:o,i=a.reduce((u,c)=>{if(c.title)u[c.key]=c;else if(c.uid)u[c.uid]=c;else if(c.key){u[c.key]=c;let f=o.find(l=>l.key===c.key)||{};Object.assign(c,f,{...c})}return u},{}),s=await B.getUserPromptList("sidebar");if(s?.List?.length){for(let u of s.List)i[u.id]?Object.assign(i[u.id],{uid:u.id,title:u.name,template:u.content}):a.unshift({uid:u.id,key:`custom-${Date.now()}${u.id}`,title:u.name,template:u.content,visible:u.status==="Valid"});await le.default.storage.local.set({__DONT_SYNC__:`pullSidebarTpl${Date.now()}`,sidebarPromptTemplate:a.filter(u=>u.title)})}}async function Ml(){let t=await le.default.storage.local.get(null),e={};return Object.keys(t).forEach(r=>{r in Rl&&(e[r]=t[r])}),e}function Rv(t,e){let r=[];if(t[e]&&typeof t[e]=="object"){for(let[n,o]of Object.entries(t[e]))r.push({__key__:n,...o||{}});t[e]=r}}function Iv(t,e){let r={};if(Array.isArray(t[e])){for(let n of t[e])r[n.__key__]=n,delete n.__key__;t[e]=r}}async function jv(t,e,r,n,o){let a=await vr(),i;if(a.provider==="chatgpt"){let f=await he({onRefresh:()=>t.postMessage({event:"GUARD_TAB_REFRESHING"}),throwGuideError:!0});i=new Lr(f)}else if(a.provider==="gpt3"){let{apiKey:f,enableCustomURL:l,customURL:p,model:d}=a.configs["gpt3"],y=l&&p?p:"";i=new on(f,d||xn,y)}else if(a.provider==="siderApi")i=new an(n);else throw new Error(`Unknown provider ${a.provider}`);let s=()=>{},u=new AbortController;t.onDisconnect.addListener(()=>{u.abort(),s?.()}),s=(await i.generateAnswer({prompt:e,type:r,signal:u.signal,historyMsg:o,onEvent(f){if(f.type==="done"){t.postMessage({event:"DONE"});return}t.postMessage(f.data)}})).cleanup||(()=>{})}var Lv=fe(async()=>{let e=(await P.default.storage.local.get("webAppModelsLastUpdateTime")).webAppModelsLastUpdateTime;(!e||e-Date.now()>1e3*60*60*24)&&Rs().then(r=>{P.default.storage.local.set({webAppModels:r.models,webAppModelsLastUpdateTime:Date.now()})})},1e3),Nv=async()=>kl().then(async t=>{if(t.data){let e=t.data.filter(a=>["gpt-3.5-turbo","gpt-4","gpt-4-32k"].includes(a.id)).map(a=>({name:a.id})),n=(await P.default.storage.local.get("provider:gpt3"))["provider:gpt3"],o={apiModels:e};return n&&n.model&&(e.find(a=>a.name===n.model)||(o["provider:gpt3"]={...n,model:xn})),P.default.storage.local.set(o)}});function Dl(t){En({target:{tabId:t},files:["content-all.js"]}).catch(e=>{}),En({target:{tabId:t,allFrames:!0},files:["all-frames.js"]}).catch(e=>{})}P.default.runtime.onConnect.addListener(t=>{t.onMessage.addListener(async e=>{if(e.type=="chat")try{await Tl(t,e.data)}catch(r){t.postMessage({type:"chat-answer-error",text:r.toString(),error:r})}else try{await jv(t,e.question,"",e.cid,e.historyMsg)}catch(r){t.postMessage({error:r.message})}})});var sn=!1;P.default.runtime.onMessage.addListener(async(t,e)=>{if(t.type==="FEEDBACK"){let r=await Vn();await Es(r,t.data)}else if(t.type==="OPEN_OPTIONS_PAGE")$i(t.section,t.hash);else{if(t.type==="GET_ACCESS_TOKEN")return Vn();if(t.type==="SEND_CHATGPT")return Rr({prompt:t.promt});if(t.type==="IS_CHAT_LOGIN")return Qi().then(r=>{e.tab?.id&&P.default.tabs.sendMessage(e.tab.id,{type:"CHAT_LOGIN_STATE",value:r})});if(t.type==="POPUP_OPEN")return tr(t.isShow);if(t.type==="OPEN_URL_IN_NEW_TAB")return P.default.tabs.create(t.details);if(t.type==="UPDATE_TAB")return Fi(t.queryInfo,t.updateDetails);if(t.type==="RELOAD_TAB")return Ui(t.queryInfo);if(t.type==="GET_CHATGPT_MODELS")return Lv();if(t.type==="GET_API_MODELS")return await Nv();if(t.type==="GET_COOKIE")try{let r=await P.default.cookies.get(t.data);return r?.value?decodeURIComponent(r.value):null}catch(r){return Promise.reject(r)}else if(t.type==="SET_COOKIE")try{return await P.default.cookies.set(t.data)}catch(r){return Promise.reject(r)}else if(t.type==="SET_PROMPT_BY_I18N"){if(t.tplType==="search")return Cl(t.translation);if(t.tplType==="sidebar")return El(t.translation,t.prevTranslation)}else if(t.type==="USER_LOGIN"&&!sn)B.getVipInfo(),Vo(),sn=!0;else if(t.type==="USER_LOGOUT"&&sn)B.getVipInfo(),sn=!1;else if(t.type==="PULL_SETTINGS_FROM_CLOUD")Nl();else if(t.type==="REFRESH_VIP_INFO")Je(async()=>{if(!(await B.getVipInfo()).isVIP)throw new Error("")},2e3);else if(t.type==="CONTINUE_IN_CHAT")P.default.tabs.sendMessage(e.tab?.id,{...t,type:"DO_CONTINUE_IN_CHAT"});else{if(t.type==="CHECK_PINNED")return!!(await P.default.action.getUserSettings())?.isOnToolbar;t.type==="OPEN_CHAT_PAGE"?Rn("",()=>{P.default.runtime.sendMessage({type:"switchChat",data:{contact:"chat",conversation:t.currentCid}})},()=>_e({activeConversation:{contact:"chat",conversation:t.currentCid}})):t.type==="GO_LOGIN"&&Yi()}}if(t.type==="OPEN_URL")P.default.tabs.create({url:t.url});else if(t.type==="chat-get-chatGPT-models")return await tn.getModels();switch(t.type){case"QUERY_SELECTION":return P.default.tabs.sendMessage(t.tabId||e.tab?.id,{type:"query-selection",selectionText:t.selectionText});case"TOGGLE_HOST_TRANSLATOR_FAB":return Dv(t,e);case"TOGGLE_SIDEBAR":tr(t.isShow);break;case"GUARD_CHATGPT_TAB":Is();break}});P.default.runtime.onInstalled.addListener(t=>{t.reason==="install"&&(setTimeout(()=>{P.default.tabs.create({url:"setup.html"})},200),P.default.storage.local.set({installedAt:Date.now(),installedFirstVersion:P.default.runtime.getManifest().version})),(t.reason==="install"||t.reason==="update")&&P.default.tabs.query({active:!0,currentWindow:!0}).then(e=>{let r=e[0].id;P.default.tabs.sendMessage(r,{type:"check"}).catch(n=>{Dl(r)})}),t.reason=="update"&&P.default.storage.local.get(["provider:gpt3","modelReseted"]).then(e=>{e.modelReseted||P.default.storage.local.set({__DONT_SYNC__:`provider:gpt3${Date.now()}`,"provider:gpt3":{...e["provider:gpt3"],model:"gpt-3.5-turbo"},modelReseted:!0})}),t.reason=="update"&&P.default.storage.local.get("language").then(e=>{let r=e.language;r&&!Ft[r]&&P.default.storage.local.set({__DONT_SYNC__:`updateLangConfig${Date.now()}`,language:Ie[r]||"en"})})});P.default.tabs.onActivated.addListener(t=>{let e=t.tabId;P.default.tabs.sendMessage(e,{type:"check"}).catch(r=>{Dl(e)})});P.default.contextMenus.create({contexts:["selection"],id:"query-selection",title:"Ask ChatGPT"});P.default.contextMenus.onClicked.addListener((t,e)=>{switch(t.menuItemId){case"query-selection":t.selectionText&&e?.id&&P.default.tabs.sendMessage(e.id,{type:"query-selection",selectionText:t.selectionText}).then(r=>{r||Rr({prompt:t.selectionText})}).catch(()=>{Rr({prompt:t.selectionText})});break}});P.default.runtime.onMessageExternal.addListener((t,e,r)=>{r(!0),tr()});function Mv(t){if(!t)return"";if(t.startsWith("chrome://newtab")||t.startsWith("edge://newtab"))return"newTab";if(t.startsWith("edge"))return"edgePage";if(t.startsWith("chrome"))return"chromePage";if(t.startsWith("https://microsoftedge.microsoft.com/addons"))return"edgeStore";if(t.startsWith("https://chrome.google.com/webstore"))return"webstore"}P.default.action.onClicked.addListener(t=>{t.status==="loading"?P.default.runtime.onMessage.addListener(function e(r,n){n.tab&&n.tab.id===t.id&&r.type==="sidebar-ready"&&(P.default.runtime.onMessage.removeListener(e),tr())}):tr()});async function tr(t){let e=await P.default.tabs.query({active:!0,currentWindow:!0});try{await P.default.tabs.sendMessage(e[0].id,{type:"toggle-sidebar",isShow:t})}catch{return Rn(Mv(e[0].url)),!1}return{action:"close"}}function Dv(t,e){ws({translatorHostConfig:Ni}).then(({translatorHostConfig:r})=>{let n=t.host,o=t.favicon;try{n=n||new URL(e.url||"").host,o=o||e.tab?.favIconUrl||e.url+"/favicon.ico"}catch{}let a=r[n]?.enable===!1;return typeof t.enable=="boolean"&&(a=t.enable),r={...r,[n]:{favicon:o,enable:a}},a==!0&&delete r[n],P.default.storage.local.set({translatorHostConfig:r})})}$o();Il();async function Fv(){await B.getVipInfo()}Fv();})();
